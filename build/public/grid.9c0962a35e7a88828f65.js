(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{480:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return d}));var a=n(18),s=n(6);const i=e=>e.data[0],r=e=>e[s.l],c=e=>e.data,l=Object(a.c)(r,c),o=Object(a.c)(i,r),d=Object(a.c)(o,c)},482:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return i})),n.d(t,"g",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return o})),n.d(t,"h",(function(){return d}));const a=38,s=25,i=30,r=10,c=100,l=300,o=130,d=10},492:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0),s=n.n(a),i=n(482);const r=e=>{const{renderRow:t,hoveredRowDatum:n,rowsData:a,visibleRowsIndexRange:r,highlightedRowIndex:c}=e,[l,o]=r,d=a.slice(l,o);return s.a.createElement(s.a.Fragment,null,d.map((e,a)=>{const s=l+a,r=s*i.e,o=s===c;return t({highlight:o||e===n,dimmed:!o&&null!==c,top:r,index:s,datum:e})}))}},494:function(e,t,n){"use strict";function a(e){const t=e.series.series.count();return e.hasComparison()?3*t:t}n.d(t,"a",(function(){return a}))},496:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(0),s=n.n(a),i=n(3),r=n(13);const c=n(284),l=({direction:e})=>s.a.createElement(r.a,{svg:c,className:Object(i.b)("sort-arrow",e)})},507:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0),s=n.n(a),i=n(3);const r=({className:e,highlight:t,dimmed:n,children:a,style:r})=>s.a.createElement("div",{className:Object(i.b)("split-value",e,{dimmed:n,highlight:t}),style:r},a)},508:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(0),s=n.n(a);const i=({children:e})=>s.a.createElement("div",{className:"corner"},e)},512:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(0),s=n.n(a);function i(e,t){return function(n){return s.a.createElement(e,Object.assign({},n,t))}}},513:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(82);function s(e,t){return e.getConcreteSeries().groupBy(e=>e.reactKey()).map(e=>e.first()).toMap().map(e=>{const n=t.map(t=>e.selectValue(t));return a.k().domain(a.b([0,...n])).range([0,100])})}},514:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(482);function s(e,t,n){return[Math.max(0,Math.floor(n/a.e)),Math.min(e,Math.ceil((n+t)/a.e))]}},517:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(0),s=n.n(a),i=n(492),r=n(3),c=n(19),l=n(484);const o=({highlight:e,width:t})=>s.a.createElement("div",{className:"measure-background-container"},s.a.createElement("div",{className:Object(r.b)("measure-background",{highlight:e}),style:{width:t+"%"}})),d=e=>{const{width:t,value:n,children:a}=e;return s.a.createElement("div",{className:"measure-cell",style:{width:t}},a,s.a.createElement("div",{className:"measure-label"},n))},u=e=>{const{series:t,datum:n,barScale:a,highlight:i,showPrevious:r,cellWidth:u}=e,m=t.selectValue(n),h=s.a.createElement(d,{key:t.reactKey(),width:u,value:t.formatValue(n)},a&&s.a.createElement(o,{highlight:i,width:a(m)}));if(!r)return h;const p=t.selectValue(n,c.b.PREVIOUS);return s.a.createElement(s.a.Fragment,null,h,s.a.createElement(d,{key:t.reactKey(c.b.PREVIOUS),width:u,value:t.formatValue(n,c.b.PREVIOUS)},a&&s.a.createElement(o,{highlight:i,width:a(p)})),s.a.createElement(d,{width:u,key:t.reactKey(c.b.DELTA),value:s.a.createElement(l.a,{currentValue:m,previousValue:p,lowerIsBetter:t.measure.lowerIsBetter,formatter:t.formatter()})}))},m=e=>{const{datum:t,showBar:n,scales:a,cellWidth:i,highlight:c,dimmed:l,style:o,essence:d}=e,m=d.getConcreteSeries().toArray();return s.a.createElement("div",{className:Object(r.b)("measure-row",{highlight:c,dimmed:l}),style:o},m.map(e=>s.a.createElement(u,{key:e.reactKey(),series:e,datum:t,highlight:c,barScale:n?a.get(e.reactKey()):null,cellWidth:i,showPrevious:d.hasComparison()})))},h=e=>{const{rowWidth:t,showBarPredicate:n,essence:a,cellWidth:r,hoverRow:c,scales:l,data:o,visibleRowsIndexRange:d,highlightedRowIndex:u}=e;return s.a.createElement(i.a,{visibleRowsIndexRange:d,highlightedRowIndex:u,hoveredRowDatum:c,rowsData:o,renderRow:e=>{const{index:i,top:c,datum:o,highlight:d,dimmed:u}=e,h={top:c,width:t},p=n(o);return s.a.createElement(m,{key:"row_"+i,essence:a,highlight:d,dimmed:u,style:h,datum:o,cellWidth:r,showBar:p,scales:l})}})}},519:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(0),s=n.n(a),i=n(19),r=n(14),c=n(3),l=n(496);const o=({sort:e,width:t,title:n,className:a})=>{const i=null!==e;return s.a.createElement("div",{className:Object(c.b)("measure-header-cell",a,{sorted:i}),style:{width:t}},s.a.createElement("div",{className:"title-wrap"},n),e&&s.a.createElement(l.a,{direction:e}))};function d(e,t,n=i.b.CURRENT){return e instanceof r.b&&e.reference===t.definition.key()&&e.period===n?e.direction:null}const u=e=>{const{cellWidth:t,series:n,sort:a,showPrevious:r}=e;return s.a.createElement(s.a.Fragment,null,n.map(e=>{const n=s.a.createElement(o,{key:e.reactKey(),width:t,title:e.title(),sort:d(a,e)});return r?s.a.createElement(s.a.Fragment,{key:e.reactKey()},n,s.a.createElement(o,{key:e.reactKey(i.b.PREVIOUS),width:t,title:e.title(i.b.PREVIOUS),sort:d(a,e,i.b.PREVIOUS)}),s.a.createElement(o,{className:"measure-delta",key:e.reactKey(i.b.DELTA),width:t,title:"Difference",sort:d(a,e,i.b.DELTA)})):n}))}},524:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(0),s=n.n(a),i=n(482),r=n(492),c=n(507);const l=e=>{const{splitLabel:t,data:n,highlightedRowIndex:a,hoverRow:l,visibleRowsIndexRange:o,segmentWidth:d}=e;return s.a.createElement("div",{className:"flattened-splits-rows"},s.a.createElement(r.a,{visibleRowsIndexRange:o,highlightedRowIndex:a,rowsData:n,hoveredRowDatum:l,renderRow:e=>{const{index:n,top:a,datum:r,highlight:l,dimmed:o}=e,u={width:d-i.g,top:a};return s.a.createElement(c.a,{key:"splits_"+n,className:"flattened-splits-row",style:u,dimmed:o,highlight:l},s.a.createElement(t,{datum:r}))}}))}},525:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0),s=n.n(a),i=n(8),r=n(14),c=n(508),l=n(496);const o=({sort:e,splits:t,dataCube:n})=>s.a.createElement(c.a,null,s.a.createElement("div",{className:"header-split-columns"},t.splits.toArray().map(t=>{const{reference:a}=t,c=Object(i.d)(n.dimensions,a).title,o=function(e,t){return t instanceof r.a&&e.reference===t.reference?t.direction:null}(t,e);return s.a.createElement("div",{className:"header-split-column",key:a},s.a.createElement("div",{className:"header-split-column-title"},c),o&&s.a.createElement("div",{className:"header-split-column-sort-icon"},s.a.createElement(l.a,{direction:o})))})))},527:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0),s=n.n(a),i=n(83);const r=({splits:e,datum:t,timezone:n})=>s.a.createElement(s.a.Fragment,null,e.map(e=>{const{reference:a}=e,r=e.selectValue(t);return s.a.createElement("div",{key:a,className:"flattened-split-value"},Object(i.b)(r,n))}))},578:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Y}));var a=n(1),s=n(0),i=n.n(s),r=n(482),c=n(512),l=n(485),o=n(55),d=n(14),u=n(494),m=n(8),h=n(19),p=n(9);function g(e,t,n,a){const s=t.series.series,i=e-n,r=Math.floor(i/a);if(t.hasComparison()){const e=Object(p.i)(r,3),t=s.get(e);if(!t)return{element:"whitespace"};return{element:"series",series:t,period:(c=r,[h.b.CURRENT,h.b.PREVIOUS,h.b.DELTA][c%3])}}var c;const l=s.get(r);return l?{element:"series",series:l,period:h.b.CURRENT}:{element:"whitespace"}}function b(e){return e.splits.getSplit(0)}class f extends i.a.Component{constructor(...e){super(...e),Object(a.a)(this,"state",{scrollTop:0}),Object(a.a)(this,"setScrollTop",e=>this.setState({scrollTop:e})),Object(a.a)(this,"handleClick",(e,t,n)=>{const a=this.calculatePosition(e,t,n);switch(a.element){case"dimension":this.setSortToDimension(a.dimension);break;case"series":this.setSortToSeries(a.series,a.period)}})}getIdealColumnWidth(){const{stage:e,segmentWidth:t,essence:n}=this.props,a=e.width-r.g-t,s=Object(u.a)(n);return s*r.c>=a?r.c:a/s}setSortToSeries(e,t){const n=new d.b({reference:e.key(),period:t,direction:d.c.descending});this.setSort(n)}setSortToDimension(e){const t=new d.a({reference:e.name,direction:d.c.descending});this.setSort(t)}setSort(e){const{clicker:t,essence:n}=this.props,{splits:a}=n,s=b(n),i=s.sort.equals(e)?e.set("direction",d.c.ascending):e;t.changeSplits(a.replace(s,s.changeSort(i)),o.b.KeepAlways)}calculatePosition(e,t,n){const{segmentWidth:a,essence:s}=this.props;switch(n){case"top-left-corner":return function(e,t,n){const a=n/t.splits.length(),s=Math.floor(e/a),i=t.splits.getSplit(s),r=Object(m.d)(t.dataCube.dimensions,i.reference);return r?{element:"dimension",dimension:r}:{element:"whitespace"}}(e,s,a);case"top-gutter":return g(e,s,a,this.getIdealColumnWidth());default:return{element:"whitespace"}}}render(){const{children:e}=this.props,{scrollTop:t}=this.state;return i.a.createElement(i.a.Fragment,null,e({columnWidth:this.getIdealColumnWidth(),scrollTop:t,handleClick:this.handleClick,setScrollTop:this.setScrollTop}))}}var v=n(18),E=n(60),w=n(167),S=n(519),y=n(525),O=n(517),j=n(524),R=n(513),C=n(514),W=n(480),k=n(527);function N(e){return 0===e.__nest}const T=e=>{const{splits:t,datum:n,timezone:a}=e;return N(n)?i.a.createElement("div",{key:"totals",className:"flattened-split-value"},"Total"):i.a.createElement(k.a,{splits:t,datum:n,timezone:a})},I=e=>{const{essence:t,data:n,scrollTop:a,segmentWidth:s,setScrollTop:c,setSegmentWidth:l,handleClick:o,columnWidth:d,stage:m,availableWidth:h}=e,p=Object(W.a)(n.flatten({order:"preorder",nestingName:"__nest"})),g=Object(R.a)(t,p.filter(Object(v.b)(N))),f=p.length,k=Object(C.a)(f,m.height,a),I=Object(u.a)(t),x=h||r.f,V=b(t).sort,P={bodyWidth:d*I+r.h,bodyHeight:f*r.e,bottom:0,left:s,right:0,top:r.a},{dataCube:D,splits:K}=t;return i.a.createElement(i.a.Fragment,null,i.a.createElement(E.c,{direction:E.a.LEFT,onResize:l,min:r.f,max:x,value:s}),i.a.createElement(w.a,{layout:P,onScroll:c,onClick:o,topGutter:i.a.createElement(S.a,{cellWidth:d,series:t.getConcreteSeries().toArray(),sort:V,showPrevious:t.hasComparison()}),leftGutter:i.a.createElement(j.a,{visibleRowsIndexRange:k,data:p,splitLabel:({datum:e})=>i.a.createElement(T,{splits:t.splits.splits,timezone:t.timezone,datum:e}),segmentWidth:s,highlightedRowIndex:null}),topLeftCorner:i.a.createElement(y.a,{dataCube:D,sort:V,splits:K}),body:p&&i.a.createElement(O.a,{visibleRowsIndexRange:k,essence:t,highlightedRowIndex:null,scales:g,data:p,showBarPredicate:Object(v.b)(N),cellWidth:d,rowWidth:d*I})}))};var x=n(504),V=n(38),P=n(13),D=n(491),K=n(3),L=n(100),A=n(41),F=n(190),U=n(498),M=n(499),B=n(500),z=n(501);const G=e=>{const{essence:t,split:n,dimension:a}=e;return n.equals(b(t))?i.a.createElement(q,e):Object(V.e)(a)?i.a.createElement(_,e):null};class _ extends i.a.Component{constructor(...e){super(...e),Object(a.a)(this,"state",{granularity:Object(L.f)(this.props.split.bucket)}),Object(a.a)(this,"saveGranularity",e=>this.setState({granularity:e})),Object(a.a)(this,"saveSplit",()=>{const{split:e,saveSplit:t}=this.props;t(e,this.createSplit())})}createSplit(){const{split:e,dimension:t}=this.props,{granularity:n}=this.state;return Object(z.b)({split:e,dimension:t,granularity:n})}validate(){const{dimension:e,split:t}=this.props,{granularity:n}=this.state;return Object(z.c)({split:t,dimension:e,granularity:n})}render(){const{containerStage:e,dimension:t,onClose:n,openOn:a}=this.props,{granularity:s}=this.state;return i.a.createElement(z.a,{openOn:a,containerStage:e,onClose:n,onSave:this.saveSplit,dimension:t,isValid:this.validate()},i.a.createElement(U.a,{dimension:t,granularity:s,granularityChange:this.saveGranularity}))}}class q extends i.a.Component{constructor(...e){super(...e),Object(a.a)(this,"state",this.initState()),Object(a.a)(this,"saveGranularity",e=>this.setState({granularity:e})),Object(a.a)(this,"saveSort",e=>this.setState({sort:e})),Object(a.a)(this,"saveLimit",e=>this.setState({limit:e})),Object(a.a)(this,"saveSplit",()=>{const{split:e,saveSplit:t}=this.props;t(e,this.createSplit())})}initState(){const{split:{bucket:e,sort:t,limit:n}}=this.props;return{sort:t,limit:n,granularity:e&&Object(L.f)(e)}}createSplit(){const{split:e,dimension:t}=this.props,{limit:n,sort:a,granularity:s}=this.state;return Object(z.b)({split:e,dimension:t,limit:n,sort:a,granularity:s})}validate(){const{dimension:e,split:t}=this.props,{limit:n,sort:a,granularity:s}=this.state;return Object(z.c)({split:t,dimension:e,limit:n,sort:a,granularity:s})}render(){const{containerStage:e,dimension:t,onClose:n,essence:a,openOn:s}=this.props,{granularity:r,sort:c,limit:l}=this.state,{dimensions:o}=a.dataCube,d=[...a.splits.splits.toArray().map(({reference:e})=>new A.a(Object(m.d)(o,e))),...a.seriesSortOns(!0).toArray()];return i.a.createElement(z.a,{openOn:s,containerStage:e,onClose:n,onSave:this.saveSplit,dimension:t,isValid:this.validate()},i.a.createElement(U.a,{dimension:t,granularity:r,granularityChange:this.saveGranularity}),i.a.createElement(B.a,{direction:c.direction,selected:A.c.fromSort(c,a),options:d,onChange:this.saveSort}),i.a.createElement(M.a,{selectedLimit:l,limits:F.a,includeNone:!1,onLimitSelect:this.saveLimit}))}}const J=e=>{const{essence:t,open:a,split:s,dimension:r,style:c,removeSplit:l,updateSplit:o,openMenu:d,closeMenu:u,dragStart:m,containerStage:h}=e,p=s.equals(b(t))||Object(V.e)(r),g=s.getTitle(r),f=e=>{e.stopPropagation(),l(s)},v=()=>{p&&d(s)};return i.a.createElement(D.a,null,({ref:e,setRef:l})=>i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:Object(K.b)("tile dimension",{disabled:!p}),key:s.toKey(),ref:l,draggable:!0,onClick:v,onDragStart:e=>m(r.title,s,e),style:c,title:g},i.a.createElement("div",{className:"reading"},g),i.a.createElement("div",{className:"remove",onClick:f},i.a.createElement(P.a,{svg:n(136)}))),p&&a&&e&&i.a.createElement(G,{saveSplit:o,essence:t,openOn:e,containerStage:h,onClose:u,dimension:r,split:s})))};function H(e){return i.a.createElement(x.b,Object.assign({},e,{splitTileComponent:J}))}const Q=e=>i.a.createElement(l.c,Object.assign({},e,{splitTilesRow:H})),X=e=>{const{essence:t,segmentWidth:n,setSegmentWidth:a,stage:s,clicker:c,data:l}=e,o=s.width-r.d;return i.a.createElement("div",{className:"grid-container"},i.a.createElement(f,{essence:t,clicker:c,stage:s,segmentWidth:n},({columnWidth:e,scrollTop:r,setScrollTop:c,handleClick:d})=>i.a.createElement(I,{essence:t,data:l,stage:s,handleClick:d,setScrollTop:c,setSegmentWidth:a,availableWidth:o,columnWidth:e,segmentWidth:n,scrollTop:r})))};class Y extends i.a.Component{constructor(...e){super(...e),Object(a.a)(this,"state",{segmentWidth:r.f}),Object(a.a)(this,"setSegmentWidth",e=>{this.setState({segmentWidth:e})})}render(){const{segmentWidth:e}=this.state;return i.a.createElement(i.a.Fragment,null,i.a.createElement(Q,this.props),i.a.createElement(l.a,Object.assign({},this.props,{chartComponent:Object(c.a)(X,{segmentWidth:e,setSegmentWidth:this.setSegmentWidth})})))}}}}]);
//# sourceMappingURL=grid.9c0962a35e7a88828f65.js.map