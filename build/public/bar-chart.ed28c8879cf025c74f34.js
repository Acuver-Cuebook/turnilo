(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{672:function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return u}));var r=a(24),n=a(11),i=function(e){return e.data[0]},c=function(e){return e[n.l]},s=function(e){return e.data},l=Object(r.c)(c,s),o=Object(r.c)(i,c),u=Object(r.c)(o,s)},673:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"f",(function(){return o})),a.d(t,"d",(function(){return u}));var r=a(13);function n(e,t){return Object(r.d)(e.dataCube.dimensions,t.reference)}function i(e){return e.splits.splits.last()}function c(e){return n(e,i(e))}function s(e){return i(e).reference}function l(e){var t=e.splits.splits;return 1===t.count()?null:t.first()}function o(e){return null!==l(e)}function u(e){var t=l(e);return t&&n(e,t)}},675:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a(0),n=a.n(r),i=a(8),c=function(e){var t=e.title,a=Object(i.a)(8*t.length,80,300);return n.a.createElement("div",{className:"title",style:{minWidth:a}},t)}},678:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return c}));var r=a(37),n=a(120);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return e.ticks(t).filter((function(e){return 0!==e}))}function c(e,t){var a=Object(r.a)(e,2),i=a[0],c=a[1];return isNaN(i)||isNaN(c)?null:n.k().domain([Math.min(i,0),Math.max(c,0)]).nice(5).range([t,0])}},679:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a(0),n=a.n(r),i=a(25),c=a(682),s=function(e){var t=e.series,a=e.datum;if(!e.showPrevious)return n.a.createElement(n.a.Fragment,null,t.formatValue(a));var r=t.selectValue(a),s=t.selectValue(a,i.b.PREVIOUS),l=t.formatter();return n.a.createElement(c.a,{lowerIsBetter:t.measure.lowerIsBetter,formatter:l,current:r,previous:s})}},680:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var r=a(0),n=a.n(r),i=a(11),c=a(675),s=a(67),l=a(3),o=a(4),u=a(2),h=a(6),m=a(7),d=a(1),f=a(8),g=a(122),b=a(164),v=a(237),p=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),Object(d.a)(Object(u.a)(e),"modalRef",void 0),Object(d.a)(Object(u.a)(e),"setModalRef",(function(t){e.modalRef=t})),Object(d.a)(Object(u.a)(e),"onMouseDown",(function(t){var a=t.target;Object(f.h)(a,e.modalRef)||e.props.onClose()})),e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.children,r=e.left,i=e.top;return n.a.createElement(n.a.Fragment,null,n.a.createElement(b.a,{mouseDown:this.onMouseDown}),n.a.createElement(g.a,{left:r,top:i},n.a.createElement("div",{className:Object(f.b)("modal-bubble",t),ref:this.setModalRef},a,n.a.createElement(v.a,{direction:"up"}))))}}]),a}(n.a.Component),O=function(e){var t=e.title,a=e.children,r=e.left,l=e.top,o=e.acceptHighlight,u=e.dropHighlight;return n.a.createElement(p,{className:"highlight-modal",left:r,top:l,onClose:u},n.a.createElement(c.a,{title:t}),n.a.createElement("div",{className:"value"},a),n.a.createElement("div",{className:"actions"},n.a.createElement(s.a,{type:"primary",className:"accept mini",onClick:o,title:i.m.select}),n.a.createElement(s.a,{type:"secondary",className:"drop mini",onClick:u,title:i.m.cancel})))}},681:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return o}));var r=a(0),n=a.n(r),i=a(122),c=a(675),s=a(237),l=function(e){var t=e.left,a=e.top,r=e.title,c=e.content;return n.a.createElement(i.a,{left:t,top:a+-10},n.a.createElement("div",{className:"segment-bubble"},n.a.createElement(o,{title:r,content:c}),n.a.createElement(s.a,{direction:"up"})))},o=function(e){var t=e.title,a=e.content;return n.a.createElement("div",{className:"segment-bubble-text"},n.a.createElement(c.a,{title:t}),a?n.a.createElement("div",{className:"content"},a):null)}},682:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a(0),n=a.n(r),i=a(676),c=function(e){var t=e.lowerIsBetter,a=e.formatter,r=e.current,c=e.previous,s=a(r),l=a(c);return n.a.createElement(n.a.Fragment,null,n.a.createElement("strong",{className:"current-value"},s),n.a.createElement("span",{className:"previous-value"},l),n.a.createElement(i.a,{formatter:a,currentValue:r,previousValue:c,lowerIsBetter:t}))}},685:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a(0),n=a.n(r),i=a(8);var c=function(e){var t=e.orientation,a=e.stage,r=e.ticks,c=e.scale;return n.a.createElement("g",{className:Object(i.b)("grid-lines",t),transform:a.getTransform()},r.map((function(e){var r=Object(i.k)(c(e)),s=function(e,t,a){switch(e){case"horizontal":return{x1:0,x2:a.width,y1:t,y2:t};case"vertical":return{x1:t,x2:t,y1:0,y2:a.height}}}(t,r,a);return n.a.createElement("line",Object.assign({key:String(e)},s))})))}},687:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return o}));var r=a(9),n=a(5),i=a(70),c=a(12),s=a(694);function l(e,t){if(n.TimeRange.isTimeRange(e)){var a=new i.a(e),s=r.a.of(a);return new c.c({reference:t,values:s})}if(n.NumberRange.isNumberRange(e)){var l=new c.e(e),o=r.a.of(l);return new c.d({reference:t,values:o})}throw new Error("Expected Number or Time range, got: ".concat(e))}function o(e){if(!Object(s.a)(e))throw new Error("Expected Number or FixedTime Filter Clause. Got ".concat(e));var t=e.values.first();return n.Range.fromJS(t)}},694:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a(12);function n(e){return e instanceof r.c||e instanceof r.d}},695:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var r=a(15),n=a(0),i=a.n(n),c=a(25),s=a(676);function l(e){var t=e.color,a=e.name,n=e.series,l=e.datum,o=e.hasComparison,u={color:t,name:a,value:n.formatValue(l)};return o?Object(r.a)(Object(r.a)({},u),{},{previous:n.formatValue(l,c.b.PREVIOUS),delta:i.a.createElement(s.a,{currentValue:n.selectValue(l),previousValue:n.selectValue(l,c.b.PREVIOUS),lowerIsBetter:n.measure.lowerIsBetter,formatter:n.formatter()})}):u}},697:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a(0),n=a.n(r),i=a(25),c=a(676);var s=function(e){var t=e.series,a=e.datum,r=e.showPrevious;return n.a.createElement("div",{className:"vis-measure-label"},n.a.createElement("span",{className:"measure-title"},t.title()),n.a.createElement("span",{className:"colon"},": "),n.a.createElement("span",{className:"measure-value"},t.formatValue(a)),r&&function(e,t){var a=t.selectValue(e,i.b.CURRENT),r=t.selectValue(e,i.b.PREVIOUS),s=t.formatter();return n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{className:"measure-previous-value"},s(r)),n.a.createElement(c.a,{formatter:s,lowerIsBetter:t.measure.lowerIsBetter,currentValue:a,previousValue:r}))}(a,t))}},698:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a(0),n=a.n(r),i=a(8),c=function(e){var t=e.formatter,a=e.stage,r=e.tickSize,c=e.ticks,s=e.scale,l=e.topLineExtend,o=void 0===l?0:l,u=e.hideZero?c.filter((function(e){return 0!==e})):c,h=u.map((function(e){var t=Object(i.k)(s(e));return n.a.createElement("line",{className:"tick",key:String(e),x1:0,y1:t,x2:r,y2:t})})),m=r+2,d=u.map((function(e){var a=s(e);return n.a.createElement("text",{className:"tick",key:String(e),x:m,y:a,dy:"0.31em"},t(e))}));return n.a.createElement("g",{className:"vertical-axis",transform:a.getTransform()},n.a.createElement("line",{className:"border",x1:.5,y1:-o,x2:.5,y2:a.height}),h,d)}},701:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a(0),n=a.n(r),i=function(e){var t=e.colorEntries.map((function(e){var t=e.color,a=e.name,r=e.value,i=e.previous,c=e.delta,s={background:t};return n.a.createElement("tr",{key:a},n.a.createElement("td",null,n.a.createElement("div",{className:"color-swab",style:s})),n.a.createElement("td",{className:"color-name"},a),n.a.createElement("td",{className:"color-value"},r),i&&n.a.createElement("td",{className:"color-previous"},i),c&&n.a.createElement("td",{className:"color-delta"},c))}));return n.a.createElement("table",{className:"color-swabs"},n.a.createElement("tbody",null,t))}},707:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l}));var r=a(34),n=a(120),i=a(25),c=a(14);function s(e,t){var a=function(t){return Object(c.s)(e.selectValue(t))};return t?[a,function(t){return Object(c.s)(e.selectValue(t,i.b.PREVIOUS))}]:[a]}function l(e,t){return t.reduce((function(t,a){var i=n.b(e,a);return n.b([].concat(Object(r.a)(i),Object(r.a)(t)))}),[0,0])}},715:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var r=a(0),n=a.n(r),i=a(677),c=a(710),s=a(696),l=a(34),o=a(37),u=a(239),h=a(141),m=a(52),d=a(163),f=a(673),g=a(690),b=a(691),v=a(692),p=a(693),O=function(e){var t=e.saveSplit,a=e.containerStage,i=e.split,c=e.dimension,s=e.onClose,l=e.openOn,u=Object(r.useState)((function(){return i.bucket&&Object(h.f)(i.bucket)})),m=Object(o.a)(u,2),d=m[0],f=m[1],b=Object(p.c)({split:i,dimension:c,granularity:d});return n.a.createElement(p.a,{openOn:l,containerStage:a,onClose:s,onSave:function(){var e=Object(p.b)({dimension:c,split:i,granularity:d});t(i,e)},dimension:c,isValid:b},n.a.createElement(g.a,{granularity:d,dimension:c,granularityChange:f}))},y=function(e){var t=e.openOn,a=e.containerStage,i=e.onClose,c=e.dimension,s=e.saveSplit,h=e.split,f=e.essence,g=[new m.a(c)].concat(Object(l.a)(f.seriesSortOns(!0).toArray())),O=Object(d.b)().customization.visualizationColors.series,y=Object(r.useMemo)((function(){return Object(u.b)(O.length)}),[O.length]),E=Object(r.useState)(h.sort),S=Object(o.a)(E,2),j=S[0],x=S[1],w=Object(r.useState)(h.limit),k=Object(o.a)(w,2),C=k[0],N=k[1],V=Object(p.c)({split:h,dimension:c,limit:C,sort:j});return n.a.createElement(p.a,{openOn:t,containerStage:a,onClose:i,onSave:function(){var e=Object(p.b)({dimension:c,split:h,limit:C,sort:j});s(h,e)},dimension:c,isValid:V},n.a.createElement(v.a,{direction:j.direction,selected:m.c.fromSort(j,f),options:g,onChange:x}),n.a.createElement(b.a,{selectedLimit:C,limits:y,includeNone:!1,onLimitSelect:N}))},E=function(e){var t=e.essence;return e.split.equals(Object(f.c)(t))?n.a.createElement(O,e):n.a.createElement(y,e)},S=function(e){return n.a.createElement(c.b,Object.assign({splitMenuComponent:E},e))},j=function(e){return n.a.createElement(s.b,Object.assign({},e,{splitTileComponent:S}))},x=function(e){return n.a.createElement(i.c,Object.assign({},e,{splitTilesRow:j}))}},722:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return s}));var r=a(0),n=a.n(r),i=a(8),c=function(e){var t=e.stage,a=e.tickLength;return n.a.createElement("line",{className:"grid-border grid-bottom-border",transform:t.getTransform(),x1:0,x2:t.width+a,y1:Object(i.k)(t.height-1),y2:Object(i.k)(t.height-1)})},s=function(e){var t=e.stage;return n.a.createElement("line",{className:"grid-border grid-right-border",transform:t.getTransform(),x1:Object(i.k)(t.width-1),x2:Object(i.k)(t.width-1),y1:0,y2:t.height})}},723:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a(0),n=a.n(r);function i(e){var t=e.left,a=e.bottom,r=void 0===a?0:a,i=e.right,c=e.top,s=void 0===c?0:c,l={width:Math.max(t,0)},o={left:t,top:s,bottom:r,width:Math.max(i-t,0)},u={left:i};return n.a.createElement("div",{className:"highlighter"},n.a.createElement("div",{className:"whiteout left",style:l}),n.a.createElement("div",{className:"frame",style:o}),n.a.createElement("div",{className:"whiteout right",style:u}))}},766:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Qe}));var r=a(0),n=a.n(r),i=a(24),c=a(26),s=a(715),l=a(677),o=a(142),u=a(99);function h(e){var t=function(e,t){if("object"!==Object(u.a)(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==Object(u.a)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Object(u.a)(t)?t:String(t)}var m,d=a(32),f=a(714),g=a(241),b=a(11),v=a(672),p=a(163),O=a(240),y=a(3),E=a(4),S=a(2),j=a(6),x=a(7),w=a(1),k=a(697),C=a(678),N=a(681),V=a(37),H=a(695),R=a(701),M=a(679),B=a(15),L=a(9),T=a(673);function I(e){return e.variant===m.STACKED}function A(e,t,a){var r=a.visualizationColors,n=function(e){return{continuousSplit:Object(T.c)(e),hasComparison:e.hasComparison(),timezone:e.timezone,series:e.getConcreteSeries()}}(e);if(!Object(T.f)(e))return Object(B.a)(Object(B.a)({},n),{},{variant:m.BASE});var i=Object(T.e)(e),c=Object(T.d)(e),s=function(e,t,a){return Object(v.c)(t).reduce((function(t,r,n){var i=String(e.selectValue(r)),c=n%a.series.length,s=a.series[c];return t.set(i,s)}),Object(L.c)())}(i,t,r);return Object(B.a)(Object(B.a)({},n),{},{variant:m.STACKED,nominalSplit:i,nominalDimension:c,colors:s})}!function(e){e[e.BASE=0]="BASE",e[e.STACKED=1]="STACKED"}(m||(m={}));var P,W=function(e){var t=e.model,a=e.series,r=e.datum;if(I(t)){var i=function(e,t,a){var r=a.nominalSplit,n=a.colors,i=a.hasComparison,c=Object(v.f)(e);return n.entrySeq().toArray().map((function(e){var a=Object(V.a)(e,2),n=a[0],s=a[1],l=c.find((function(e){return String(r.selectValue(e))===n}));return l?Object(H.a)({color:s,name:n,hasComparison:i,datum:l,series:t}):{color:s,name:n,value:"-"}}))}(r,a,t);return n.a.createElement(R.a,{colorEntries:i})}return n.a.createElement(M.a,{series:a,datum:r,showPrevious:t.hasComparison})},F=function(e){var t=e.model,a=e.rect,r=a.left,i=a.top,c=e.interaction.datum,s=e.series,l=e.xScale,o=e.yScale,u=t.continuousSplit,h=t.timezone,m=o(s.selectValue(c)),d=u.selectValue(c),f=l.calculate(d)+l.bandwidth()/2;return n.a.createElement(N.a,{top:i+m,left:r+f,title:u.formatValue(c,h),content:n.a.createElement(W,{model:t,datum:c,series:s})})},z=a(243);!function(e){e[e.HOVER=0]="HOVER",e[e.HIGHLIGHT=1]="HIGHLIGHT"}(P||(P={}));var D=function(e,t){return{kind:P.HOVER,datum:t,key:e}};function X(e,t){return e.kind===t.kind&&e.key===t.key&&Object(z.b)(e.datum,t.datum)}var G=a(680),K=function(e){var t=e.model,a=t.timezone,r=t.continuousSplit,i=e.rect,c=i.left,s=i.top,l=e.interaction.datum,o=e.dropHighlight,u=e.acceptHighlight,h=e.yScale,m=e.series,d=e.xScale,f=r.selectValue(l),g=d.calculate(f)+d.bandwidth()/2,b=h(m.selectValue(l));return n.a.createElement(G.a,{title:r.formatValue(l,a),left:c+g,top:s+b,dropHighlight:o,acceptHighlight:u})},U=a(25),Y=a(723);var q=function(e){var t=e.stage,a=e.yScale,r=e.series,i=e.xScale,c=e.model,s=c.hasComparison,l=c.continuousSplit,o=e.interaction.datum,u=l.selectValue(o),h=i.calculate(u),m=h+i.bandwidth(),d=a(function(e,t,a){return a?Math.max(t.selectValue(e),t.selectValue(e,U.b.PREVIOUS)):t.selectValue(e)}(o,r,s))+t.y-5;return n.a.createElement(Y.a,{left:h,right:m,top:d})},_=function(e){var t=e.stage,a=e.dropHighlight,r=e.acceptHighlight,i=e.container,c=e.model,s=e.series,l=e.xScale,o=e.yScale,u=e.interaction,h=i.current.getBoundingClientRect();return n.a.createElement(n.a.Fragment,null,function(e){return e&&e.kind===P.HIGHLIGHT}(u)&&n.a.createElement(n.a.Fragment,null,n.a.createElement(K,{interaction:u,dropHighlight:a,acceptHighlight:r,xScale:l,yScale:o,model:c,series:s,rect:h}),n.a.createElement(q,{interaction:u,stage:t,xScale:l,yScale:o,series:s,model:c})),function(e){return e&&e.kind===P.HOVER}(u)&&n.a.createElement(F,{rect:h,interaction:u,xScale:l,yScale:o,series:s,model:c}))};var J={left:5,right:60,bottom:40};function Z(e,t,a){var r=function(e,t,a){var r=Math.max(e.width,30*t),n=e.height,i=Math.floor(n/a),c=Math.max(200,i);return d.a.fromSize(r,c)}(e.within(J),t,a);return{scroller:{bodyHeight:r.height*a,bodyWidth:r.width,top:0,left:J.left,right:J.right,bottom:J.bottom},segment:r}}var Q=a(707);function $(e,t,a){return Object(Q.a)(e,Object(Q.b)(t,a))}var ee=function(e){var t=Object(p.b)().customization.visualizationColors,a=e.datum,r=e.xScale,i=e.yScale,c=e.model.continuousSplit,s=e.series,l=i.range(),o=Object(V.a)(l,1)[0],u=c.selectValue(a),h=r.calculate(u)+5,m=r.bandwidth()-10,d=i(s.selectValue(a)),f=o-d,g=t.main;return n.a.createElement("rect",{className:"bar-chart-bar",x:h,y:d,fill:g,width:m,height:f})},te=a(239),ae=function(e){var t=Object(p.b)().customization.visualizationColors,a=e.datum,r=e.xScale,i=e.yScale,c=e.model.continuousSplit,s=e.series,l=i.range(),o=Object(V.a)(l,1)[0],u=c.selectValue(a),h=r.calculate(u),m=r.bandwidth(),d=2*(m-10)/3,f=s.selectValue(a),g=s.selectValue(a,U.b.PREVIOUS),b=i(f),v=i(g),O=t.main,y=Object(te.a)(t);return n.a.createElement(n.a.Fragment,null,n.a.createElement("rect",{className:"bar-chart-bar-previous",x:h+m-5-d,y:v,fill:y,width:d,height:o-v}),n.a.createElement("rect",{className:"bar-chart-bar",x:h+5,y:b,fill:O,width:d,height:o-b}))};function re(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U.b.CURRENT;return e[ne(t,a)]}function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U.b.CURRENT;return"__stack_base_".concat(e.plywoodKey(t))}function ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U.b.CURRENT;return function(a){var r,n=Object(v.f)(a).reduce((function(a,r){var n=a.y0,c=a.stacked,s=e.selectValue(r,t),l=ne(e,t);return{y0:s+n,stacked:Object(i.e)(c,Object(B.a)(Object(B.a)({},r),{},Object(w.a)({},l,n)))}}),{y0:0,stacked:[]}),c=n.y0,s=n.stacked,l=e.plywoodKey(t);return Object(B.a)(Object(B.a)({},a),{},(r={},Object(w.a)(r,l,c),Object(w.a)(r,b.l,Object(v.e)(a).changeData(s)),r))}}var ce=function(e){var t=e.datum,a=e.xScale,r=e.yScale,i=e.series,c=e.model,s=c.colors,l=c.continuousSplit,o=c.nominalSplit,u=Object(v.f)(t),h=l.selectValue(t),m=a.calculate(h)+5,d=a.bandwidth()-10;return n.a.createElement(n.a.Fragment,null,u.map((function(e){var t,a=String(o.selectValue(e)),c=i.selectValue(e),l=re(e,i),u=r(c+l),h=r(l)-r(c+l);return n.a.createElement("rect",{className:"bar-chart-bar-segment",key:String(a),x:m,y:u,width:d,height:h,fill:(t=e,s.get(String(o.selectValue(t))))})})))},se=a(120),le=function(e){var t=e.datum,a=e.xScale,r=e.yScale,i=e.series,c=e.model,s=c.nominalSplit,l=c.continuousSplit,o=c.colors,u=Object(v.f)(t),h=l.selectValue(t),m=a.calculate(h),d=a.bandwidth(),f=2*(d-10)/3,g=function(e){return o.get(String(s.selectValue(e)))};return n.a.createElement(n.a.Fragment,null,u.map((function(e){var t="".concat(s.selectValue(e),"--previous"),a=i.selectValue(e,U.b.PREVIOUS),c=re(e,i,U.b.PREVIOUS),l=r(a+c),o=r(c)-r(a+c),u=se.i(g(e)).darker(.8);return n.a.createElement("rect",{className:"bar-chart-bar-segment",key:String(t),x:m+d-5-f,y:l,width:f,height:o,opacity:.8,fill:u.toString()})})),u.map((function(e){var t="".concat(s.selectValue(e),"--current"),a=i.selectValue(e),c=re(e,i),l=r(a+c),o=r(c)-r(a+c),u=g(e);return n.a.createElement("rect",{className:"bar-chart-bar-previous-segment",key:t,x:m+5,y:l,width:f,height:o,fill:u})})))},oe=a(722),ue=a(685),he=a(698),me=function(e){var t=e.scale,a=e.series,r=e.stage;return n.a.createElement("div",null,n.a.createElement("svg",{viewBox:r.getViewBox()},n.a.createElement("g",{transform:"translate(-1, 0)"},n.a.createElement(he.a,{stage:r,ticks:Object(C.b)(t),tickSize:10,scale:t,formatter:a.formatter()}))))},de=function(e){var t=e.gridStage,a=e.yScale,r=Object(C.b)(a);return n.a.createElement(n.a.Fragment,null,n.a.createElement(ue.a,{orientation:"horizontal",scale:a,ticks:r,stage:t}),n.a.createElement(oe.a,{stage:t,tickLength:10}),n.a.createElement(oe.b,{stage:t}))},fe=["model"],ge=function(e){var t=e.model,a=Object(o.a)(e,fe),r=t.hasComparison;return I(t)?r?n.a.createElement(le,Object.assign({},a,{model:t})):n.a.createElement(ce,Object.assign({},a,{model:t})):r?n.a.createElement(ae,Object.assign({},a,{model:t})):n.a.createElement(ee,Object.assign({},a,{model:t}))},be=function(e){var t=e.model,a=e.stage,r=e.xScale,i=e.series,c=e.datums,s=$(c,i,t.hasComparison),l=Object(C.a)(s,a.height);return l?n.a.createElement(n.a.Fragment,null,n.a.createElement("svg",{viewBox:a.getViewBox()},n.a.createElement(de,{gridStage:a,yScale:l}),n.a.createElement("g",{transform:a.getTransform()},c.map((function(e,a){return n.a.createElement(ge,{key:a,datum:e,model:t,yScale:l,xScale:r,series:i})}))))):null},ve=function(e){Object(j.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),Object(w.a)(Object(S.a)(e),"container",n.a.createRef()),e}return Object(E.a)(a,[{key:"render",value:function(){var e=this.props,t=e.dropHighlight,a=e.acceptHighlight,r=e.interaction,i=e.model,c=e.stage,s=e.scrollLeft,l=e.series,o=e.totals,u=e.datums,h=e.xScale,m=i.hasComparison,d=c.within({top:30,bottom:0}),f=$(u,l,m),g=Object(C.a)(f,d.height);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{ref:this.container,className:"bar-chart-bars",style:c.getWidthHeight()},n.a.createElement("div",{className:"bar-chart-total",style:{left:s+10}},n.a.createElement(k.a,{series:l,datum:o,showPrevious:m})),n.a.createElement(be,{model:i,stage:d,xScale:h,series:l,datums:u}),r&&n.a.createElement(_,{interaction:r,container:this.container,stage:d,dropHighlight:t,acceptHighlight:a,model:i,xScale:h,series:l,yScale:g})))}}]),a}(n.a.Component),pe=function(e){var t=e.colors;return n.a.createElement("div",{className:"legend-values"},n.a.createElement("table",{className:"legend-values-table"},n.a.createElement("tbody",null,t.entrySeq().toArray().map((function(e){var t=Object(V.a)(e,2),a=t[0],r={background:t[1]};return n.a.createElement("tr",{key:a,className:"legend-value"},n.a.createElement("td",{className:"legend-value-color-cell"},n.a.createElement("div",{className:"legend-value-color",style:r})),n.a.createElement("td",{className:"legend-value-label"},n.a.createElement("span",{className:"legend-value-name"},a)))})))))},Oe=function(e){var t=e.model,a=t.nominalSplit,r=t.nominalDimension,i=t.colors,c=a.getTitle(r);return n.a.createElement("div",{className:"bar-chart-legend"},n.a.createElement("div",{className:"legend-header"},c),n.a.createElement(pe,{colors:i}))},ye=function(e){var t=e.dropHighlight,a=e.acceptHighlight,r=e.interaction,i=e.model,c=e.datums,s=e.xScale,l=e.scrollLeft,o=e.stage,u=e.totals,h=i.series.toArray();return n.a.createElement(n.a.Fragment,null,I(i)&&n.a.createElement(O.a,null,n.a.createElement(Oe,{model:i})),h.map((function(e){var h=!!r&&r.key===e.plywoodKey();return n.a.createElement(ve,{key:e.reactKey(),stage:o,scrollLeft:l,interaction:h&&r,series:e,xScale:s,datums:c,totals:u,model:i,acceptHighlight:a,dropHighlight:t})})))},Ee=a(5),Se=a(70),je=a(12),xe=a(687),we=function(e){Object(j.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),Object(w.a)(Object(S.a)(e),"state",{hover:null,scrollLeft:0,scrollTop:0}),Object(w.a)(Object(S.a)(e),"saveScroll",(function(t,a){e.setState({hover:null,scrollLeft:a,scrollTop:t})})),Object(w.a)(Object(S.a)(e),"saveHover",(function(t,a,r){if(!e.props.highlight){var n=e.getValueFromEvent(t,r);if(Ee.Range.isRange(n)){var i=e.getSeriesFromEvent(a,r);if(null!==i){var c=e.findDatumByValue(n),s=D(i.plywoodKey(),c),l=e.state.hover;l&&X(l,s)||e.setState({hover:s})}}}})),Object(w.a)(Object(S.a)(e),"resetHover",(function(){e.state.hover&&e.setState({hover:null})})),Object(w.a)(Object(S.a)(e),"handleClick",(function(t,a,r){var n=e.getValueFromEvent(t,r);if(Ee.TimeRange.isTimeRange(n)){e.setState({hover:null});var i=e.getSeriesFromEvent(a,r);if(null!==i){var c=e.props,s=c.saveHighlight,l=c.model.continuousSplit.reference,o=L.a.of(new Se.a(n)),u=new je.c({reference:l,values:o});s(L.a.of(u),i.plywoodKey())}}})),e}return Object(E.a)(a,[{key:"getValueFromEvent",value:function(e,t){if("body"!==t)return null;var a=this.props,r=a.layout;return a.xScale.invert(e-r.scroller.left)}},{key:"findDatumByValue",value:function(e){var t=this.props,a=t.model.continuousSplit;return t.datums.find((function(t){return Object(z.b)(e,a.selectValue(t))}))}},{key:"getSeriesFromEvent",value:function(e,t){if("body"!==t)return null;var a=this.props,r=a.layout.segment.height,n=a.model.series,i=Math.floor(e/r);return n.get(i)||null}},{key:"interaction",value:function(){var e=this.props.highlight;if(e){var t=Object(xe.b)(e.clauses.first()),a=this.findDatumByValue(t);return function(e,t){return{kind:P.HIGHLIGHT,datum:t,key:e}}(e.key,a)}return this.state.hover}},{key:"render",value:function(){var e=this.props.children,t=this.state,a=t.scrollLeft,r=t.scrollTop;return e({interaction:this.interaction(),scrollLeft:a,scrollTop:r,onScroll:this.saveScroll,onMouseLeave:this.resetHover,onMouseMove:this.saveHover,onClick:this.handleClick})}}]),a}(n.a.Component),ke=function(e){return n.a.createElement("div",{className:"spacer"})};var Ce=function(e){return e.slice().reverse()},Ne=function(e){return function(e,t){var a=Object(v.f)(e);return Object(B.a)(Object(B.a)({},e),{},Object(w.a)({},b.l,Object(v.e)(e).changeData(t(a))))}(e,Ce)};function Ve(e,t){var a=t.series,r=t.hasComparison,n=a.toArray(),c=e.map(Ne);return n.reduce((function(e,t){return function(e,t,a){return e.map((function(e){return Object(i.q)(e,ie(t),a&&ie(t,U.b.PREVIOUS))}))}(e,t,r)}),c)}var He=a(34);function Re(e,t,a){var r;return r={},Object(w.a)(r,e,t),Object(w.a)(r,b.l,new Ee.Dataset({data:a})),r}function Me(e,t){if(!I(t))return Object(v.c)(e);var a=t.continuousSplit;return e.flatten().data.reduce((function(e,t){var r,n,c,s=e.findIndex((n=t,c=(r=a).selectValue(n),function(e){var t=r.selectValue(e);return(Ee.TimeRange.isTimeRange(c)&&Ee.TimeRange.isTimeRange(t)||!(!Ee.NumberRange.isNumberRange(c)||!Ee.NumberRange.isNumberRange(t)))&&c.equals(t)}));return-1===s?Object(i.e)(e,function(e,t){var a=t[e],r=Object(o.a)(t,[e].map(h));return Re(e,a,[r])}(a.reference,t)):Object(i.o)(e,s,function(e,t,a){var r=Object(v.f)(t),n=a[e],i=Object(o.a)(a,[e].map(h));return Re(e,n,[].concat(Object(He.a)(r),[i]))}(a.reference,e[s],t))}),[]).sort(function(e){return function(t,a){var r=e.selectValue(t),n=e.selectValue(a);return r.compare(n)}}(a))}function Be(e){return Ee.TimeRange.isTimeRange(e)?e.start.toISOString():Ee.NumberRange.isNumberRange(e)?e.start.toString(10):String(e)}var Le=a(20),Te=a(121),Ie=a(8);var Ae=function(e){var t,a,r=e.model,i=e.stage,c=e.scale,s=(t=c.domain(),a=r.continuousSplit,Object(Le.c)(a)?t.filter((function(e,t){return t%8==0})):t);return n.a.createElement("svg",{width:i.width,height:i.height},n.a.createElement("g",{className:"bar-chart-x-axis"},s.map((function(e,t){var a=Object(Ie.k)(c.calculate(e)),i=0===t?"start":"middle";return n.a.createElement("g",{key:String(e),transform:"translate(".concat(a,", 0)")},n.a.createElement("line",{x1:0,x2:0,y1:0,y2:10}),n.a.createElement("text",{y:22,style:{textAnchor:i}},Object(Te.c)(e,r.timezone)))}))))},Pe=function(e){var t,a=e.model,r=e.stage,i=e.datums,c=(t=r,d.a.fromJS({x:0,y:30,width:60,height:t.height-30-0})),s=a.series.toArray();return n.a.createElement(n.a.Fragment,null,s.map((function(e){var t=$(i,e,a.hasComparison),s=Object(C.a)(t,c.height);return n.a.createElement("div",{style:r.getWidthHeight(),key:e.reactKey()},s&&n.a.createElement(me,{series:e,scale:s,stage:c}))})))},We=function(e){var t=Object(p.b)().customization,a=e.data,r=e.essence,i=e.stage,c=e.highlight,s=e.acceptHighlight,l=e.dropHighlight,u=e.saveHighlight,m=A(r,a,t),O=Me(a,m);if(0===O.length)return n.a.createElement(f.a,{title:"No data found. Try different filters."});var y,E,S=Object(v.d)(a),j=(S[b.l],Object(o.a)(S,[b.l].map(h))),x=I(m)?Ve(O,m):O,w=m.series.count(),k=(y=x,E=m.continuousSplit,y.map((function(e){return E.selectValue(e)}))),C=Z(i,k.length,w),N=C.scroller,V=C.segment,H=function(e,t){var a=[0,t],r=e.map(Be),n=se.j().domain(r).rangeRound(a),i=se.m().domain(a).range(e);return{calculate:function(e){return n(Be(e))},domain:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return e})),invert:function(e){return i(e)},bandwidth:function(){return n.bandwidth()}}}(k,V.width);return n.a.createElement(we,{xScale:H,model:m,datums:x,layout:C,saveHighlight:u,highlight:c},(function(e){var t=e.onClick,a=e.onScroll,r=e.onMouseLeave,i=e.onMouseMove,c=e.interaction,o=e.scrollLeft;return n.a.createElement(g.a,{layout:N,onMouseLeave:r,onClick:t,onScroll:a,onMouseMove:i,leftGutter:n.a.createElement(ke,null),bottomLeftCorner:n.a.createElement(ke,null),bottomRightCorner:n.a.createElement(ke,null),body:n.a.createElement(ye,{interaction:c,datums:x,totals:j,stage:V,scrollLeft:o,model:m,xScale:H,acceptHighlight:s,dropHighlight:l}),rightGutter:n.a.createElement(Pe,{model:m,datums:x,stage:d.a.fromSize(N.right,V.height)}),bottomGutter:n.a.createElement(Ae,{model:m,scale:H,stage:d.a.fromSize(V.width,N.bottom)})})}))},Fe=a(48),ze=a(13),De=a(19),Xe=a(263),Ge=a(85),Ke=function(e){Object(j.a)(a,e);var t=Object(x.a)(a);function a(){return Object(y.a)(this,a),t.apply(this,arguments)}return Object(E.a)(a,[{key:"render",value:function(){var e=this.props,t=e.stage,a=e.ticks,r=e.scale,i=t.width,c=[];function s(e,t){i<e||c.push(n.a.createElement("line",{key:t,x1:e,y1:0,x2:e,y2:5}))}var l,o=Object(Ge.a)(a);try{for(o.s();!(l=o.n()).done;){var u=l.value;s(Object(Ie.k)(r(u)),"_"+u)}}catch(e){o.e(e)}finally{o.f()}a.length&&s(Object(Ie.k)(r(a[a.length-1])+r.bandwidth()),"last");return n.a.createElement("g",{className:"bucket-marks",transform:t.getTransform()},c)}}]),a}(n.a.Component),Ue=a(682),Ye=a(727),qe=function(){function e(t){Object(y.a)(this,e),Object(w.a)(this,"x",void 0),Object(w.a)(this,"y",void 0),Object(w.a)(this,"height",void 0),Object(w.a)(this,"width",void 0),Object(w.a)(this,"barOffset",void 0),Object(w.a)(this,"barWidth",void 0),Object(w.a)(this,"stepWidth",void 0),Object(w.a)(this,"children",void 0),Object(w.a)(this,"hitboxMin",void 0),Object(w.a)(this,"hitboxMax",void 0),this.x=t.x,this.y=t.y,this.height=t.height,this.width=t.width,this.barOffset=t.barOffset,this.barWidth=t.barWidth,this.stepWidth=t.stepWidth,this.children=t.children,this.hitboxMin=this.x-this.barOffset,this.hitboxMax=this.x+this.barWidth+2*this.barOffset}return Object(E.a)(e,[{key:"isXWithin",value:function(e){return e>=this.hitboxMin&&e<=this.hitboxMax}},{key:"hasChildren",value:function(){return this.children.length>0}},{key:"middleX",get:function(){return this.x+.5*this.barWidth+this.barOffset}}]),e}();function _e(e,t){return Object(L.a)(t.map((function(t,a){var r=e.getSplit(a),n=r.type,i=r.reference,c=t[i];switch(n){case Le.b.boolean:return new je.a({reference:i,values:L.f.of(c)});case Le.b.number:return new je.d({reference:i,values:L.a.of(c)});case Le.b.time:return new je.c({reference:i,values:L.a.of(new Se.a(c))});case Le.b.string:return new je.h({reference:i,action:je.g.IN,values:L.f.of(c)})}})))}var Je=function(e){Object(j.a)(a,e);var t=Object(x.a)(a);function a(){var e;Object(y.a)(this,a);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),Object(w.a)(Object(S.a)(e),"className",Xe.a.name),Object(w.a)(Object(S.a)(e),"coordinatesCache",[]),Object(w.a)(Object(S.a)(e),"scroller",n.a.createRef()),Object(w.a)(Object(S.a)(e),"state",e.initState()),Object(w.a)(Object(S.a)(e),"context",void 0),Object(w.a)(Object(S.a)(e),"onScrollerScroll",(function(t,a){e.setState({hoverInfo:null,scrollLeft:a,scrollTop:t})})),Object(w.a)(Object(S.a)(e),"onMouseMove",(function(t,a){e.setState({hoverInfo:e.calculateMousePosition(t,a)})})),Object(w.a)(Object(S.a)(e),"onMouseLeave",(function(){e.setState({hoverInfo:null})})),Object(w.a)(Object(S.a)(e),"onClick",(function(t,a){var r=e.props,n=r.essence,i=r.highlight,c=r.dropHighlight,s=r.saveHighlight,l=e.calculateMousePosition(t,a);if(l){if(!l.coordinates)return c(),void e.setState({selectionInfo:null});var o=l.path,u=l.chartIndex,h=n.splits,m=n.getConcreteSeries(),d=_e(h,o),f=m.get(u).definition;if(Object(Ye.b)(i,f.key())&&d.equals(i.clauses))return c(),void e.setState({selectionInfo:null});e.setState({selectionInfo:l}),s(d,m.get(u).definition.key())}})),e}return Object(E.a)(a,[{key:"componentDidUpdate",value:function(){var e=this.state,t=e.scrollerYPosition,a=e.scrollerXPosition,r=this.scroller.current;if(r){var n=r.scroller.current.getBoundingClientRect();t===n.top&&a===n.left||this.setState({scrollerYPosition:n.top,scrollerXPosition:n.left})}}},{key:"calculateMousePosition",value:function(e,t){var a=this.props.essence.getConcreteSeries(),r=this.getSingleChartStage(),n=this.getOuterChartHeight(r);if(t>=n*a.size)return null;if(e>=r.width)return null;var i=this.getPrimaryXScale(),c=Math.floor(t/n),s=this.getBarsCoordinates(c,i),l=this.findBarCoordinatesForX(e,s,[]),o=l.path,u=l.coordinates;return{path:this.findPathForIndices(o),series:a.get(c),chartIndex:c,coordinates:u}}},{key:"findPathForIndices",value:function(e){var t=this.props.data.data[0][b.l],a=[],r=t;return e.forEach((function(e){var t=r.data[e];a.push(t),r=t[b.l]})),a}},{key:"findBarCoordinatesForX",value:function(e,t,a){for(var r=0;r<t.length;r++)if(t[r].isXWithin(e))return a.push(r),t[r].hasChildren()?this.findBarCoordinatesForX(e,t[r].children,a):{path:a,coordinates:t[r]};return{path:[],coordinates:null}}},{key:"getYExtent",value:function(e,t){return se.b(e,(function(e){return t.selectValue(e)}))}},{key:"getYScale",value:function(e,t){var a=this.props.essence,r=this.state.flatData,n=a.splits.length(),i=r.filter((function(e){return e.__nest===n-1})),c=this.getYExtent(i,e);return se.k().domain([Math.min(1.1*c[0],0),Math.max(1.1*c[1],0)]).range([t.height,t.y])}},{key:"hasValidYExtent",value:function(e,t){var a=this.getYExtent(t,e),r=Object(V.a)(a,2),n=r[0],i=r[1];return!isNaN(n)&&!isNaN(i)}},{key:"getSingleChartStage",value:function(){var e=this.getPrimaryXScale(),t=this.props,a=t.essence,r=t.stage,n=this.getBarDimensions(e.bandwidth()).stepWidth,i=e.domain(),c=i.length>0?Object(Ie.l)(e(i[i.length-1]))+n:0,s=a.getConcreteSeries(),l=r.height-84,o=Math.max(200,Math.floor(l/s.size));return new d.a({x:0,y:10,width:Math.max(c,r.width-60-2*b.n),height:o-10-0})}},{key:"getOuterChartHeight",value:function(e){return e.height+10+0}},{key:"getAxisStages",value:function(e){var t=this.props,a=t.essence,r=t.stage,n=Math.max(r.height-(10+e.height)*a.getConcreteSeries().size,84);return{xAxisStage:new d.a({x:e.x,y:0,height:n,width:e.width}),yAxisStage:new d.a({x:0,y:e.y,height:e.height,width:60+b.n})}}},{key:"getScrollerLayout",value:function(e,t,a){var r=this.props.essence.getConcreteSeries().toArray(),n=this.getOuterChartHeight(e);return{bodyWidth:e.width,bodyHeight:n*r.length-0,top:0,right:a.width,bottom:t.height,left:0}}},{key:"getBubbleTopOffset",value:function(e,t,a){var r=this.state,n=r.scrollTop,i=r.scrollerYPosition;return this.getOuterChartHeight(a)*t-n+i+e-8+10}},{key:"getBubbleLeftOffset",value:function(e){var t=this.state,a=t.scrollLeft;return t.scrollerXPosition+e-a}},{key:"canShowBubble",value:function(e,t){var a=this.props.stage,r=this.state,n=r.scrollerYPosition,i=r.scrollerXPosition;return!(t<=0)&&(!(t>n+a.height-84)&&(!(e<=0)&&!(e>i+a.width-60)))}},{key:"renderSelectionBubble",value:function(e){var t=this.props,a=t.dropHighlight,r=t.acceptHighlight,i=e.series,c=e.path,s=e.chartIndex,l=e.segmentLabel,o=e.coordinates,u=this.getSingleChartStage(),h=this.getBubbleLeftOffset(o.middleX),m=this.getBubbleTopOffset(o.y,s,u);if(!this.canShowBubble(h,m))return null;var d=i.formatValue(c[c.length-1]);return n.a.createElement(G.a,{left:h,top:m,dropHighlight:a,acceptHighlight:r,title:l},d)}},{key:"renderHoverBubble",value:function(e){var t=this.getSingleChartStage(),a=e.series,r=e.path,i=e.chartIndex,c=e.segmentLabel,s=e.coordinates,l=this.getBubbleLeftOffset(s.middleX),o=this.getBubbleTopOffset(s.y,i,t);if(!this.canShowBubble(l,o))return null;var u=this.renderMeasureLabel(r[r.length-1],a);return n.a.createElement(N.a,{top:o,left:l,title:c,content:u})}},{key:"renderMeasureLabel",value:function(e,t){if(!this.props.essence.hasComparison())return t.formatValue(e);var a=t.selectValue(e),r=t.selectValue(e,U.b.PREVIOUS),i=t.formatter();return n.a.createElement(Ue.a,{lowerIsBetter:t.measure.lowerIsBetter,formatter:i,current:a,previous:r})}},{key:"isSelected",value:function(e,t){var a=this.props,r=a.essence,n=a.highlight,i=r.splits;return Object(Ye.b)(n,t.key())&&n.clauses.equals(_e(i,e))}},{key:"isFaded",value:function(){return null!==this.props.highlight}},{key:"hasAnySelectionGoingOn",value:function(){return null!==this.props.highlight}},{key:"isHovered",value:function(e,t){var a=this.props.essence,r=this.state.hoverInfo,n=a.splits;if(this.hasAnySelectionGoingOn())return!1;if(!r)return!1;if(!r.series.equals(t))return!1;var i=function(e){return _e(n,e)};return i(r.path).equals(i(e))}},{key:"renderBars",value:function(e,t,a,r,i,c){var s,l=this,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],h=this.props.essence,m=h.timezone,d=this.context.customization.visualizationColors,f=[],g=Object(ze.d)(h.dataCube.dimensions,h.splits.splits.get(o).reference),v=h.splits.length();return e.forEach((function(e,h){var p,O=e[g.name],y=Object(Te.d)(O,m),E=u.concat(e),S=null,j=c[h],x=c[h],w=x.x,k=x.y,C=x.height,N=x.barWidth,V=x.barOffset;if(o<v-1){var H=e[b.l].data,R=l.renderBars(H,t,a,r,i,j.children,o+1,E);p=R.bars,!s&&R.highlight&&(s=R.highlight)}else{var M={series:t,chartIndex:a,path:E,coordinates:j,segmentLabel:y,splitIndex:o},B=l.isHovered(E,t);B&&(S=l.renderHoverBubble(M));var L=l.isSelected(E,t.definition),T=l.isFaded();L&&(S=l.renderSelectionBubble(M))&&(s=l.renderSelectionHighlight(r,j,a)),p=n.a.createElement("g",{className:Object(Ie.b)("bar",{selected:L,"not-selected":!L&&T,isHovered:B}),key:String(O),transform:"translate(".concat(Object(Ie.l)(w),", 0)")},n.a.createElement("rect",{className:"background",width:Object(Ie.l)(N),height:Object(Ie.l)(Math.abs(C)),fill:d.main,x:V,y:Object(Ie.l)(k)}),S)}f.push(p)})),{bars:f,highlight:s}}},{key:"renderSelectionHighlight",value:function(e,t,a){var r=this.state,i=r.scrollLeft,c=r.scrollTop,s=this.getOuterChartHeight(e),l=t.barWidth,o=t.height,u=t.barOffset,h=t.y,m=t.x,d={left:Object(Ie.l)(m)+u-4+e.x-i,top:Object(Ie.l)(h)-4+e.y-c+s*a,width:Object(Ie.l)(l+8),height:Object(Ie.l)(Math.abs(o)+8)};return n.a.createElement("div",{className:"selection-highlight",style:d})}},{key:"renderXAxis",value:function(e,t,a){var r=this.props.essence,i=this.getPrimaryXScale(),c=i.domain(),s=r.splits.splits.first(),l=Object(ze.d)(r.dataCube.dimensions,s.reference),o=[];if(Object(Fe.b)(l)){var u=e.length-1,h=s.sort.direction===De.c.ascending,m=h?"start":"end",d=h?"end":"start";e.forEach((function(e,r){var i=e[l.name],c=String(Ee.Range.isRange(i)?i[m]:""),s=t[r];o.push(n.a.createElement("div",{className:"slanty-label continuous",key:r,style:{right:a.width-s.x}},c)),r===u&&(c=String(Ee.Range.isRange(i)?i[d]:""),o.push(n.a.createElement("div",{className:"slanty-label continuous",key:"last-one",style:{right:a.width-(s.x+s.stepWidth)}},c)))}))}else e.forEach((function(e,r){var i=String(e[l.name]),c=t[r];o.push(n.a.createElement("div",{className:"slanty-label categorical",key:i,style:{right:a.width-(c.x+c.stepWidth/2)}},i))}));return n.a.createElement("div",{className:"x-axis",style:{width:a.width}},n.a.createElement("svg",{style:a.getWidthHeight(),viewBox:a.getViewBox()},n.a.createElement(Ke,{stage:a,ticks:c,scale:i})),o)}},{key:"getYAxisStuff",value:function(e,t,a,r){var i=this.getAxisStages(a).yAxisStage,c=this.getYScale(t,i),s=c.ticks(5),l=n.a.createElement(ue.a,{orientation:"horizontal",scale:c,ticks:s,stage:a}),o=i.changeY(i.y+(a.height+10+0)*r);return{yGridLines:l,yAxis:n.a.createElement(he.a,{formatter:t.formatter(),key:t.reactKey(),stage:o,ticks:s,tickSize:5,scale:c,hideZero:!0}),yScale:c}}},{key:"isChartVisible",value:function(e,t){var a=this.props.stage,r=this.state.scrollTop,n=this.getSingleChartStage(),i=this.getOuterChartHeight(n),c=e*i,s=a.height-t.height;return!(c+i<r)&&!(c-r>=s)}},{key:"renderChart",value:function(e,t,a,r,i){var c=this.props.essence,s=e.data[0][b.l],l=n.a.createElement(k.a,{series:a,datum:e.data[0],showPrevious:c.hasComparison()});if(!this.hasValidYExtent(a,s.data))return{chart:n.a.createElement("div",{className:"measure-bar-chart",key:a.reactKey(),style:{width:i.width}},n.a.createElement("svg",{style:i.getWidthHeight(0,0),viewBox:i.getViewBox(0,0)}),l),yAxis:null,highlight:null};var o,u,h=this.getAxisStages(i).xAxisStage,m=this.getYAxisStuff(s,a,i,r),d=m.yAxis,f=m.yGridLines;if(this.isChartVisible(r,h)){var g=this.renderBars(s.data,a,r,i,h,t);o=g.bars,u=g.highlight}return{chart:n.a.createElement("div",{className:"measure-bar-chart",key:a.reactKey(),style:{width:i.width}},n.a.createElement("svg",{style:i.getWidthHeight(0,0),viewBox:i.getViewBox(0,0)},f,n.a.createElement("g",{className:"bars",transform:i.getTransform()},o)),l),yAxis:d,highlight:u}}},{key:"initState",value:function(){var e=this.props,t=e.essence,a=e.data,r=t.splits;if(this.coordinatesCache=[],!r.length())return{};var n=r.splits.first(),i=Object(ze.d)(t.dataCube.dimensions,n.reference),c=i.kind,s=t.getConcreteSeries().toArray(),l=("number"===c?function(e,t,a){var r=e.data[0][b.l].data,n=t.name,i=r[0][n];if(!i)return e;var c=Number(i.start),s=Number(i.end)-c,l=c,o=0,u=[];r.forEach((function(e){for(var t=e[n].start;l<t;)u[o]={},u[o][n]=Ee.NumberRange.fromJS({start:l,end:l+s}),a.forEach((function(e){u[o][e.name]=0})),e[b.l]&&(u[o][b.l]=new Ee.Dataset({data:[],attributes:[]})),o++,l+=s;u[o]=e,l+=s,o++}));var h=e.valueOf();return h.data[0][b.l].data=u,new Ee.Dataset(h)}(a,i,s.map((function(e){return e.measure}))):a).data[0][b.l],o=l.flatten({order:"preorder",nestingName:"__nest"}),u=r.splits.map((function(){return 0})).toArray();return this.maxNumberOfLeaves(l.data,u,0),{hoverInfo:null,maxNumberOfLeaves:u,flatData:o.data,scrollTop:0,scrollLeft:0}}},{key:"maxNumberOfLeaves",value:function(e,t,a){if(t[a]=Math.max(t[a],e.length),e[0]&&void 0!==e[0][b.l])for(var r=e.length,n=0;n<r;n++)this.maxNumberOfLeaves(e[n][b.l].data,t,a+1)}},{key:"getPrimaryXScale",value:function(){var e=this.props.data,t=this.state.maxNumberOfLeaves,a=e.data[0][b.l].data,r=this.props.essence,n=r.splits,i=r.dataCube,c=n.splits.first(),s=Object(ze.d)(i.dimensions,c.reference),l=this.getXValues(t),o=l.usedWidth,u=l.padLeft;return se.j().domain(a.map((function(e){return e[s.name]}))).range([u,u+o])}},{key:"getBarDimensions",value:function(e){isNaN(e)&&(e=0);var t=e,a=Math.max(.8*t,0);return{stepWidth:t,barWidth:a,barOffset:(t-a)/2}}},{key:"getXValues",value:function(e){var t=this.props,a=t.essence,r=t.stage.width-2*b.n-60,n=e[0],i=20*e.slice(1).reduce((function(e,t){return e*t}),1),c=r-30-6,s=(i*n<c?Math.max(Math.min(c/n,140*a.splits.length()),20):i)*e[0];return{padLeft:Math.max(30,(r-s)/2),usedWidth:s}}},{key:"getBarsCoordinates",value:function(e,t){if(this.coordinatesCache[e])return this.coordinatesCache[e];var a=this.props.data.data[0][b.l],r=this.props.essence,n=r.splits,i=r.dataCube,c=r.getConcreteSeries().get(e),s=n.splits.first(),l=Object(ze.d)(i.dimensions,s.reference),o=this.getSingleChartStage(),u=this.getYScale(c,this.getAxisStages(o).yAxisStage);return this.coordinatesCache[e]=this.getSubCoordinates(a.data,c,o,(function(e){return e[l.name]}),t,u),this.coordinatesCache[e]}},{key:"getSubCoordinates",value:function(e,t,a,r,n,i){var c=this,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=this.props.essence,o=this.state.maxNumberOfLeaves,u=this.getBarDimensions(n.bandwidth()),h=u.stepWidth,m=u.barWidth,f=u.barOffset,g=e.map((function(e,u){var g=n(r(e,u)),v=i(t.selectValue(e)),p=i(0)-v,O=new qe({x:g,y:p>=0?v:i(0),width:Object(Ie.l)(m),height:Object(Ie.l)(Math.abs(p)),stepWidth:h,barWidth:m,barOffset:f,children:[]});if(s<l.splits.length()){var y=new d.a({x:g,y:a.y,width:m,height:a.height}),E=e[b.l].data,S=se.j().domain(se.h(0,o[s]).map(String)).range([g+f,g+y.width]);O.children=c.getSubCoordinates(E,t,y,(function(e,t){return String(t)}),S,i,s+1)}return O}));return g}},{key:"renderRightGutter",value:function(e,t,a){var r=t.changeHeight((t.height+10+0)*e);return n.a.createElement("svg",{style:r.getWidthHeight(),viewBox:r.getViewBox()},a)}},{key:"renderSelectionContainer",value:function(e,t,a){return n.a.createElement("div",{className:"selection-highlight-container"},e)}},{key:"render",value:function(){var e,t,a,r,i=this,c=this.props,s=c.data,l=c.essence,o=c.stage,u=l.splits,h=[];if(u.length()){var m=this.getPrimaryXScale(),d=[],f=l.getConcreteSeries(),v=this.getSingleChartStage(),p=this.getAxisStages(v),O=p.xAxisStage,y=p.yAxisStage;t=this.renderXAxis(s.data[0][b.l].data,this.getBarsCoordinates(0,m),O),f.forEach((function(e,t){var a=i.getBarsCoordinates(t,m),n=i.renderChart(s,a,e,t,v),c=n.yAxis,l=n.chart,o=n.highlight;h.push(l),d.push(c),o&&(r=i.renderSelectionContainer(o,t,v))})),e=this.getScrollerLayout(v,O,y),a=this.renderRightGutter(f.count(),v,d)}return n.a.createElement("div",{className:"measure-bar-charts",style:{height:o.height}},n.a.createElement(g.a,{layout:e,ref:this.scroller,bottomGutter:t,rightGutter:a,body:h,overlay:r,onClick:this.onClick,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,onScroll:this.onScrollerScroll}))}}]),a}(n.a.Component);Object(w.a)(Je,"contextType",p.a);var Ze=Object(i.m)(c.a.areExactSplitKinds("time"),c.a.areExactSplitKinds("*","time"),c.a.areExactSplitKinds("number"),c.a.areExactSplitKinds("*","number"));function Qe(e){return Ze(e.essence)?n.a.createElement(n.a.Fragment,null,n.a.createElement(s.a,e),n.a.createElement(l.a,Object.assign({},e,{chartComponent:We}))):n.a.createElement(n.a.Fragment,null,n.a.createElement(l.b,e),n.a.createElement(l.a,Object.assign({},e,{chartComponent:Je})))}}}]);
//# sourceMappingURL=bar-chart.ed28c8879cf025c74f34.js.map