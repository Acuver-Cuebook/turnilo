(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{672:function(e,t,a){"use strict";a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"f",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return u}));var n=a(24),r=a(11),c=function(e){return e.data[0]},i=function(e){return e[r.l]},o=function(e){return e.data},s=Object(n.c)(i,o),l=Object(n.c)(c,i),u=Object(n.c)(l,o)},673:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"d",(function(){return u}));var n=a(13);function r(e,t){return Object(n.d)(e.dataCube.dimensions,t.reference)}function c(e){return e.splits.splits.last()}function i(e){return r(e,c(e))}function o(e){return c(e).reference}function s(e){var t=e.splits.splits;return 1===t.count()?null:t.first()}function l(e){return null!==s(e)}function u(e){var t=s(e);return t&&r(e,t)}},675:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(0),r=a.n(n),c=a(8),i=function(e){var t=e.title,a=Object(c.a)(8*t.length,80,300);return r.a.createElement("div",{className:"title",style:{minWidth:a}},t)}},678:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return i}));var n=a(37),r=a(120);function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return e.ticks(t).filter((function(e){return 0!==e}))}function i(e,t){var a=Object(n.a)(e,2),c=a[0],i=a[1];return isNaN(c)||isNaN(i)?null:r.k().domain([Math.min(c,0),Math.max(i,0)]).nice(5).range([t,0])}},679:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(0),r=a.n(n),c=a(25),i=a(682),o=function(e){var t=e.series,a=e.datum;if(!e.showPrevious)return r.a.createElement(r.a.Fragment,null,t.formatValue(a));var n=t.selectValue(a),o=t.selectValue(a,c.b.PREVIOUS),s=t.formatter();return r.a.createElement(i.a,{lowerIsBetter:t.measure.lowerIsBetter,formatter:s,current:n,previous:o})}},680:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(0),r=a.n(n),c=a(11),i=a(675),o=a(67),s=a(3),l=a(4),u=a(2),m=a(6),f=a(7),d=a(1),v=a(8),g=a(122),h=a(164),b=a(237),O=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),Object(d.a)(Object(u.a)(e),"modalRef",void 0),Object(d.a)(Object(u.a)(e),"setModalRef",(function(t){e.modalRef=t})),Object(d.a)(Object(u.a)(e),"onMouseDown",(function(t){var a=t.target;Object(v.h)(a,e.modalRef)||e.props.onClose()})),e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.children,n=e.left,c=e.top;return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{mouseDown:this.onMouseDown}),r.a.createElement(g.a,{left:n,top:c},r.a.createElement("div",{className:Object(v.b)("modal-bubble",t),ref:this.setModalRef},a,r.a.createElement(b.a,{direction:"up"}))))}}]),a}(r.a.Component),p=function(e){var t=e.title,a=e.children,n=e.left,s=e.top,l=e.acceptHighlight,u=e.dropHighlight;return r.a.createElement(O,{className:"highlight-modal",left:n,top:s,onClose:u},r.a.createElement(i.a,{title:t}),r.a.createElement("div",{className:"value"},a),r.a.createElement("div",{className:"actions"},r.a.createElement(o.a,{type:"primary",className:"accept mini",onClick:l,title:c.m.select}),r.a.createElement(o.a,{type:"secondary",className:"drop mini",onClick:u,title:c.m.cancel})))}},681:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l}));var n=a(0),r=a.n(n),c=a(122),i=a(675),o=a(237),s=function(e){var t=e.left,a=e.top,n=e.title,i=e.content;return r.a.createElement(c.a,{left:t,top:a+-10},r.a.createElement("div",{className:"segment-bubble"},r.a.createElement(l,{title:n,content:i}),r.a.createElement(o.a,{direction:"up"})))},l=function(e){var t=e.title,a=e.content;return r.a.createElement("div",{className:"segment-bubble-text"},r.a.createElement(i.a,{title:t}),a?r.a.createElement("div",{className:"content"},a):null)}},682:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(0),r=a.n(n),c=a(676),i=function(e){var t=e.lowerIsBetter,a=e.formatter,n=e.current,i=e.previous,o=a(n),s=a(i);return r.a.createElement(r.a.Fragment,null,r.a.createElement("strong",{className:"current-value"},o),r.a.createElement("span",{className:"previous-value"},s),r.a.createElement(c.a,{formatter:a,currentValue:n,previousValue:i,lowerIsBetter:t}))}},685:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(0),r=a.n(n),c=a(8);var i=function(e){var t=e.orientation,a=e.stage,n=e.ticks,i=e.scale;return r.a.createElement("g",{className:Object(c.b)("grid-lines",t),transform:a.getTransform()},n.map((function(e){var n=Object(c.k)(i(e)),o=function(e,t,a){switch(e){case"horizontal":return{x1:0,x2:a.width,y1:t,y2:t};case"vertical":return{x1:t,x2:t,y1:0,y2:a.height}}}(t,n,a);return r.a.createElement("line",Object.assign({key:String(e)},o))})))}},687:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l}));var n=a(9),r=a(5),c=a(70),i=a(12),o=a(694);function s(e,t){if(r.TimeRange.isTimeRange(e)){var a=new c.a(e),o=n.a.of(a);return new i.c({reference:t,values:o})}if(r.NumberRange.isNumberRange(e)){var s=new i.e(e),l=n.a.of(s);return new i.d({reference:t,values:l})}throw new Error("Expected Number or Time range, got: ".concat(e))}function l(e){if(!Object(o.a)(e))throw new Error("Expected Number or FixedTime Filter Clause. Got ".concat(e));var t=e.values.first();return r.Range.fromJS(t)}},694:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(12);function r(e){return e instanceof n.c||e instanceof n.d}},695:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(15),r=a(0),c=a.n(r),i=a(25),o=a(676);function s(e){var t=e.color,a=e.name,r=e.series,s=e.datum,l=e.hasComparison,u={color:t,name:a,value:r.formatValue(s)};return l?Object(n.a)(Object(n.a)({},u),{},{previous:r.formatValue(s,i.b.PREVIOUS),delta:c.a.createElement(o.a,{currentValue:r.selectValue(s),previousValue:r.selectValue(s,i.b.PREVIOUS),lowerIsBetter:r.measure.lowerIsBetter,formatter:r.formatter()})}):u}},697:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(0),r=a.n(n),c=a(25),i=a(676);var o=function(e){var t=e.series,a=e.datum,n=e.showPrevious;return r.a.createElement("div",{className:"vis-measure-label"},r.a.createElement("span",{className:"measure-title"},t.title()),r.a.createElement("span",{className:"colon"},": "),r.a.createElement("span",{className:"measure-value"},t.formatValue(a)),n&&function(e,t){var a=t.selectValue(e,c.b.CURRENT),n=t.selectValue(e,c.b.PREVIOUS),o=t.formatter();return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"measure-previous-value"},o(n)),r.a.createElement(i.a,{formatter:o,lowerIsBetter:t.measure.lowerIsBetter,currentValue:a,previousValue:n}))}(a,t))}},698:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(0),r=a.n(n),c=a(8),i=function(e){var t=e.formatter,a=e.stage,n=e.tickSize,i=e.ticks,o=e.scale,s=e.topLineExtend,l=void 0===s?0:s,u=e.hideZero?i.filter((function(e){return 0!==e})):i,m=u.map((function(e){var t=Object(c.k)(o(e));return r.a.createElement("line",{className:"tick",key:String(e),x1:0,y1:t,x2:n,y2:t})})),f=n+2,d=u.map((function(e){var a=o(e);return r.a.createElement("text",{className:"tick",key:String(e),x:f,y:a,dy:"0.31em"},t(e))}));return r.a.createElement("g",{className:"vertical-axis",transform:a.getTransform()},r.a.createElement("line",{className:"border",x1:.5,y1:-l,x2:.5,y2:a.height}),m,d)}},701:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n),c=function(e){var t=e.colorEntries.map((function(e){var t=e.color,a=e.name,n=e.value,c=e.previous,i=e.delta,o={background:t};return r.a.createElement("tr",{key:a},r.a.createElement("td",null,r.a.createElement("div",{className:"color-swab",style:o})),r.a.createElement("td",{className:"color-name"},a),r.a.createElement("td",{className:"color-value"},n),c&&r.a.createElement("td",{className:"color-previous"},c),i&&r.a.createElement("td",{className:"color-delta"},i))}));return r.a.createElement("table",{className:"color-swabs"},r.a.createElement("tbody",null,t))}},707:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return s}));var n=a(34),r=a(120),c=a(25),i=a(14);function o(e,t){var a=function(t){return Object(i.s)(e.selectValue(t))};return t?[a,function(t){return Object(i.s)(e.selectValue(t,c.b.PREVIOUS))}]:[a]}function s(e,t){return t.reduce((function(t,a){var c=r.b(e,a);return r.b([].concat(Object(n.a)(c),Object(n.a)(t)))}),[0,0])}},712:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(3),r=a(4),c=a(2),i=a(6),o=a(7),s=a(1),l=a(0),u=a.n(l);function m(e,t){var a=e.top,n=e.left,r=e.stage,c=e.margin,i=void 0===c?10:c;if(!t)return{top:a+i,left:n+i};var o=r.y+r.height,s=r.x+r.width;return{top:t.bottom>o?a-i-t.height:t.top<r.y?a+t.height:a+i,left:t.right>s?n-i-t.width:t.left<r.x?n+t.width:n+i}}var f=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),Object(s.a)(Object(c.a)(e),"self",u.a.createRef()),Object(s.a)(Object(c.a)(e),"state",{}),e}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.setState({rect:this.self.current.getBoundingClientRect()})}},{key:"render",value:function(){var e=this.props.children;return u.a.createElement("div",{className:"tooltip-within-stage",style:m(this.props,this.state.rect),ref:this.self},e)}}]),a}(u.a.Component)},715:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(0),r=a.n(n),c=a(677),i=a(710),o=a(696),s=a(34),l=a(37),u=a(239),m=a(141),f=a(52),d=a(163),v=a(673),g=a(690),h=a(691),b=a(692),O=a(693),p=function(e){var t=e.saveSplit,a=e.containerStage,c=e.split,i=e.dimension,o=e.onClose,s=e.openOn,u=Object(n.useState)((function(){return c.bucket&&Object(m.f)(c.bucket)})),f=Object(l.a)(u,2),d=f[0],v=f[1],h=Object(O.c)({split:c,dimension:i,granularity:d});return r.a.createElement(O.a,{openOn:s,containerStage:a,onClose:o,onSave:function(){var e=Object(O.b)({dimension:i,split:c,granularity:d});t(c,e)},dimension:i,isValid:h},r.a.createElement(g.a,{granularity:d,dimension:i,granularityChange:v}))},j=function(e){var t=e.openOn,a=e.containerStage,c=e.onClose,i=e.dimension,o=e.saveSplit,m=e.split,v=e.essence,g=[new f.a(i)].concat(Object(s.a)(v.seriesSortOns(!0).toArray())),p=Object(d.b)().customization.visualizationColors.series,j=Object(n.useMemo)((function(){return Object(u.b)(p.length)}),[p.length]),E=Object(n.useState)(m.sort),S=Object(l.a)(E,2),y=S[0],x=S[1],k=Object(n.useState)(m.limit),N=Object(l.a)(k,2),w=N[0],R=N[1],C=Object(O.c)({split:m,dimension:i,limit:w,sort:y});return r.a.createElement(O.a,{openOn:t,containerStage:a,onClose:c,onSave:function(){var e=Object(O.b)({dimension:i,split:m,limit:w,sort:y});o(m,e)},dimension:i,isValid:C},r.a.createElement(b.a,{direction:y.direction,selected:f.c.fromSort(y,v),options:g,onChange:x}),r.a.createElement(h.a,{selectedLimit:w,limits:j,includeNone:!1,onLimitSelect:R}))},E=function(e){var t=e.essence;return e.split.equals(Object(v.c)(t))?r.a.createElement(p,e):r.a.createElement(j,e)},S=function(e){return r.a.createElement(i.b,Object.assign({splitMenuComponent:E},e))},y=function(e){return r.a.createElement(o.b,Object.assign({},e,{splitTileComponent:S}))},x=function(e){return r.a.createElement(c.c,Object.assign({},e,{splitTilesRow:y}))}},722:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var n=a(0),r=a.n(n),c=a(8),i=function(e){var t=e.stage,a=e.tickLength;return r.a.createElement("line",{className:"grid-border grid-bottom-border",transform:t.getTransform(),x1:0,x2:t.width+a,y1:Object(c.k)(t.height-1),y2:Object(c.k)(t.height-1)})},o=function(e){var t=e.stage;return r.a.createElement("line",{className:"grid-border grid-right-border",transform:t.getTransform(),x1:Object(c.k)(t.width-1),x2:Object(c.k)(t.width-1),y1:0,y2:t.height})}},723:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n);function c(e){var t=e.left,a=e.bottom,n=void 0===a?0:a,c=e.right,i=e.top,o=void 0===i?0:i,s={width:Math.max(t,0)},l={left:t,top:o,bottom:n,width:Math.max(c-t,0)},u={left:c};return r.a.createElement("div",{className:"highlighter"},r.a.createElement("div",{className:"whiteout left",style:s}),r.a.createElement("div",{className:"frame",style:l}),r.a.createElement("div",{className:"whiteout right",style:u}))}},767:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Qe}));var n=a(3),r=a(4),c=a(2),i=a(6),o=a(7),s=a(1),l=a(0),u=a.n(l),m=a(370),f=a(714),d=a(715),v=a(677),g=a(240),h=a(13),b=a(672),O=a(163),p=function(e){var t=Object(O.b)().customization.visualizationColors,a=e.values;return u.a.createElement("div",{className:"legend-values"},u.a.createElement("table",{className:"legend-values-table"},u.a.createElement("tbody",null,a.map((function(e,a){var n={background:t.series[a]};return u.a.createElement("tr",{key:e,className:"legend-value"},u.a.createElement("td",{className:"legend-value-color-cell"},u.a.createElement("div",{className:"legend-value-color",style:n})),u.a.createElement("td",{className:"legend-value-label"},u.a.createElement("span",{className:"legend-value-name"},e)))})))))},j=function(e){var t=e.values,a=e.title;return u.a.createElement("div",{className:"line-chart-legend"},u.a.createElement("div",{className:"legend-header"},a),u.a.createElement(p,{values:t}))},E=function(e){var t=e.essence,a=e.dataset,n=t.splits.splits.first(),r=Object(h.d)(t.dataCube.dimensions,n.reference),c=n.getTitle(r),i=Object(b.c)(a).map((function(e){return String(n.selectValue(e))}));return u.a.createElement(j,{values:i,title:c})},S=a(673),y=a(32),x=a(11);function k(e,t){var a=e.width-2*x.n,n=a/1,r=(e.height-30)/t,c=Math.floor(Math.min(n,r)),i=Math.max(200,c);return new y.a({x:x.n,y:0,width:a,height:i})}var N,w=a(697),R=a(37),C=a(678);function H(e){var t,a=e.currentTarget,n=e.clientX||0,r=e.clientY||0,c=(t=a)===window?{top:0,left:0}:t.getBoundingClientRect();return[n-c.left,r-c.top]}!function(e){e[e.HOVER=0]="HOVER",e[e.DRAGGING=1]="DRAGGING",e[e.HIGHLIGHT=2]="HIGHLIGHT"}(N||(N={}));var z=function(e,t){return{kind:N.HOVER,range:t,key:e}},V=function(e){return e&&e.kind===N.HOVER},T=function(e,t,a){return{kind:N.DRAGGING,start:t,end:a,key:e}},I=function(e){return e&&e.kind===N.DRAGGING},D=function(e){return e&&e.kind===N.HIGHLIGHT},A=a(722),M=a(685),G=a(698),F=function(e){var t=e.formatter,a=e.gridStage,n=e.axisStage,r=e.xScale,c=e.yScale,i=e.xTicks;return u.a.createElement(u.a.Fragment,null,u.a.createElement(M.a,{orientation:"horizontal",scale:c,ticks:Object(C.b)(c),stage:a}),u.a.createElement(M.a,{orientation:"vertical",scale:r,ticks:i,stage:a}),u.a.createElement(G.a,{tickSize:5,stage:n,formatter:t,ticks:Object(C.b)(c),scale:c}),u.a.createElement(A.a,{stage:a,tickLength:5}))},B=a(121),L=a(680),U=a(687),P=function(e){var t=e.rect,a=t.left,n=t.top,r=e.interaction,c=e.timezone,i=e.dropHighlight,o=e.acceptHighlight,s=e.xScale,l=Object(U.b)(r.clause),m=s(l.midpoint());return u.a.createElement(L.a,{title:Object(B.d)(l,c),left:a+m,top:n+80,dropHighlight:i,acceptHighlight:o})},J=a(681),X=a(712),K=function(e){var t=e.content,a=e.interaction,n=e.xScale,r=e.timezone,c=e.stage,i=a.range,o=n(i.midpoint());return u.a.createElement(X.a,{key:o,top:60,left:o,stage:c},u.a.createElement(J.b,{title:Object(B.d)(i,r),content:t}))},W=a(5),Y=a(723),q=a(16);function Z(e,t,a){var n=function(e,t,a){return e>t?[t,e]:t>e?[e,t]:[e,Q(e,a)]}(e,t,a),r=Object(R.a)(n,2),c=r[0],i=r[1];return W.Range.fromJS({start:c,end:i})}function Q(e,t){return e instanceof Date?q.second.shift(e,t,1):e+1}var $=a(694);var _=function(e){var t=e.stage,a=e.timezone,n=e.interaction,r=e.xScale,c=function(e,t){if(I(e))return Z(e.start,e.end,t);if(D(e)){var a=e.clause;if(!Object($.a)(a))throw new Error("Expected FixedTime or Number Filter clause. Got: ".concat(a));return W.Range.fromJS(a.values.first())}return null}(n,a);if(!c)return null;var i=r(c.start),o=r(c.end);return u.a.createElement("div",{style:t.getLeftTopWidthHeight()},u.a.createElement(Y.a,{left:i,right:o}))},ee=function(e){var t=e.stage,a=e.interaction,n=e.container,r=e.xScale,c=e.timezone,i=e.visualisationStage,o=e.hoverContent,s=e.dropHighlight,l=e.acceptHighlight;return u.a.createElement(u.a.Fragment,null,u.a.createElement(_,{stage:t,interaction:a,timezone:c,xScale:r}),V(a)&&u.a.createElement(K,{stage:i,interaction:a,xScale:r,content:o,timezone:c}),D(a)&&u.a.createElement(P,{rect:n.current.getBoundingClientRect(),interaction:a,xScale:r,timezone:c,dropHighlight:s,acceptHighlight:l}))},te=function(e){var t=e.stage,a=e.hover.range,n=e.yScale,r=(0,e.xScale)(a.midpoint()),c=n.range(),i=Object(R.a)(c,2);i[0],i[1];return u.a.createElement("line",{transform:t.getTransform(),x1:r,x2:r,y1:0,y2:t.height,className:"hover-guide"})},ae=function(e){return H(e)[0]},ne=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),Object(s.a)(Object(c.a)(e),"container",u.a.createRef()),e}return Object(r.a)(a,[{key:"render",value:function(){var e=this.props,t=e.hoverContent,a=e.interactions,n=e.timezone,r=e.yDomain,c=e.visualisationStage,i=e.chartStage,o=e.chartId,s=e.children,l=e.label,m=e.formatter,f=e.xScale,d=e.xTicks,v=a.interaction,g=a.dropHighlight,h=a.acceptHighlight,b=a.mouseLeave,O=a.dragStart,p=a.handleHover,j=f.range(),E=Object(R.a)(j,2)[1],S=i.within({top:36,right:i.width-E}),y=i.within({top:36,left:E}),x=Object(C.a)(r,S.height),k=v&&v.key===o;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"line-base-chart",ref:this.container,style:i.getWidthHeight()},u.a.createElement("svg",{className:"chart-stage",viewBox:i.getViewBox()},u.a.createElement(F,{axisStage:y,formatter:m,gridStage:S,xScale:f,xTicks:d,yScale:x}),s({yScale:x,lineStage:S}),k&&V(v)&&u.a.createElement(te,{hover:v,stage:S,yScale:x,xScale:f})),u.a.createElement("div",{style:S.getWidthHeight(),className:"event-region",onMouseDown:function(e){return O(o,ae(e))},onMouseMove:function(e){return p(o,ae(e))},onMouseLeave:b}),l,k&&u.a.createElement(ee,{container:this.container,stage:S,visualisationStage:c,interaction:v,hoverContent:t,dropHighlight:g,acceptHighlight:h,xScale:f,timezone:n})))}}]),a}(u.a.Component),re=a(25),ce=a(14),ie=a(120),oe=a(239),se=a(24);function le(e,t){return e&&t&&e.end.valueOf()!==t.start.valueOf()}function ue(e){var t=e.end.valueOf()-e.start.valueOf();return e.midpoint().valueOf()+t}function me(e){var t=e.end.valueOf()-e.start.valueOf();return e.midpoint().valueOf()-t}function fe(e,t,a){return Object(se.i)(e,(function(n,r){var c=t(n),i=c.midpoint().valueOf(),o=a(n),s=isNaN(o)?0:o;return Object(se.d)(function(e,t,a){var n=e[t-1];if(!n)return!1;var r=e[t];return le(a(n),a(r))}(e,r,t)&&[me(c),0],[i,s],function(e,t,a){var n=e[t+1];return!!n&&le(a(e[t]),a(n))}(e,r,t)&&[ue(c),0])}))}var de=function(e){var t=Object(O.b)().customization.visualizationColors,a=t.main,n=e.color,r=void 0===n?a:n,c=e.dashed,i=e.getX,o=e.getY,s=e.dataset,l=e.showArea,m=e.stage,f=e.xScale,d=e.yScale,v=ie.a().y0(d(0)),g=ie.e(),h=fe(s,i,o),b=h.map((function(e){var t=Object(R.a)(e,2),a=t[0],n=t[1];return[f(a),d(n)]})),p=h.length>1,j=1===h.length;return u.a.createElement("g",{className:"chart-line",transform:m.getTransform()},p&&u.a.createElement("path",{className:"line",d:g(b),stroke:r,strokeDasharray:c?"4 2":void 0}),p&&l&&u.a.createElement("path",{className:"area",fill:Object(oe.a)(t),d:v(b)}),j&&u.a.createElement("circle",{className:"singleton",cx:b[0][0],cy:b[0][1],r:"2",style:{fill:r}}))},ve=function(e){var t=e.showArea,a=e.essence,n=e.series,r=e.getX,c=e.stage,i=e.dataset,o=e.xScale,s=e.yScale,l=e.color,m=a.hasComparison();return u.a.createElement(u.a.Fragment,{key:n.reactKey()},u.a.createElement(de,{key:"current",xScale:o,yScale:s,getX:r,getY:function(e){return Object(ce.s)(n.selectValue(e))},showArea:t,color:l,dashed:!1,dataset:i,stage:c}),m&&u.a.createElement(de,{key:"previous",xScale:o,yScale:s,getX:r,getY:function(e){return Object(ce.s)(n.selectValue(e,re.b.PREVIOUS))},showArea:t,color:l,dashed:!0,dataset:i,stage:c}))},ge=function(e){return u.a.createElement(ve,Object.assign({},e,{showArea:!1}))},he=function(e){return u.a.createElement(ve,Object.assign({},e,{showArea:!0}))},be=a(34),Oe=a(707);var pe=a(695),je=a(701),Ee=a(679);function Se(e,t,a,n,r){var c=e.data,i=Object(S.e)(n),o=Object(S.b)(n),s=n.hasComparison();return c.map((function(e,n){var c=String(i.selectValue(e)),l=r.series[n],u=function(e,t,a){var n=Object(b.e)(e);return null!=n?n.findDatumByAttribute(t,a):null}(e,o,t);return u?Object(pe.a)({color:l,name:c,series:a,datum:u,hasComparison:s}):{color:l,name:c,value:"-"}}))}var ye=function(e){var t=Object(O.b)().customization.visualizationColors,a=e.essence,n=e.range,r=e.series,c=e.dataset;if(Object(S.f)(a)){var i=Se(c,n,r,a,t);return u.a.createElement(je.a,{colorEntries:i})}return u.a.createElement(u.a.Fragment,null,function(e,t,a,n){var r=Object(S.a)(n),c=e.findDatumByAttribute(r.name,t);return c?u.a.createElement(Ee.a,{series:a,datum:c,showPrevious:n.hasComparison()}):null}(c,n,r,a))},xe=function(e){var t=Object(O.b)().customization.visualizationColors,a=e.chartId,n=e.interactions,r=e.visualisationStage,c=e.chartStage,i=e.essence,o=e.series,s=e.xScale,l=e.xTicks,m=e.dataset,f=i.hasComparison(),d=Object(b.b)(m),v=n.interaction,g=V(v)&&u.a.createElement(ye,{essence:i,dataset:d,range:v.range,series:o}),h=u.a.createElement(w.a,{series:o,datum:Object(b.d)(m),showPrevious:f}),p=Object(S.c)(i),j=function(e){return p.selectValue(e)},E=function(e,t,a){var n=Object(Oe.b)(a,t.hasComparison());return Object(S.f)(t)?e.data.reduce((function(e,t){var a=Object(b.e)(t);if(!a)return e;var r=Object(Oe.a)(a.data,n);return ie.b([].concat(Object(be.a)(e),Object(be.a)(r)))}),[0,0]):Object(Oe.a)(e.data,n)}(d,i,o);if(Object(S.f)(i)){var y=Object(S.e)(i);return u.a.createElement(ne,{visualisationStage:r,chartId:a,interactions:n,hoverContent:g,timezone:i.timezone,label:h,xScale:s,xTicks:l,chartStage:c,formatter:o.formatter(),yDomain:E},(function(e){var a=e.yScale,n=e.lineStage;return u.a.createElement(u.a.Fragment,null,d.data.map((function(e,r){var c=y.selectValue(e),l=t.series[r];return u.a.createElement(ge,{key:String(c),xScale:s,yScale:a,getX:j,color:l,dataset:Object(b.f)(e),stage:n,essence:i,series:o})})))}))}return u.a.createElement(ne,{chartId:o.plywoodKey(),visualisationStage:r,interactions:n,hoverContent:g,timezone:i.timezone,label:h,chartStage:c,yDomain:E,formatter:o.formatter(),xScale:s,xTicks:l},(function(e){var t=e.yScale,a=e.lineStage;return u.a.createElement(he,{xScale:s,yScale:t,getX:j,dataset:d.data,stage:a,essence:i,series:o})}))},ke=function(e){var t=e.interactions,a=e.xScale,n=e.xTicks,r=e.essence,c=e.dataset,i=e.stage,o=r.getConcreteSeries().toArray(),s=k(i,r.series.count());return u.a.createElement(u.a.Fragment,null,Object(S.f)(r)&&u.a.createElement(g.a,null,u.a.createElement(E,{dataset:c,essence:r})),o.map((function(e){var o=e.reactKey();return u.a.createElement(xe,{interactions:t,key:o,chartId:o,dataset:c,essence:r,series:e,chartStage:s,visualisationStage:i,xScale:a,xTicks:n})})))},Ne=function(e){var t=e.essence.getConcreteSeries().toArray().map((function(e){return e.title()}));return u.a.createElement(j,{values:t,title:"Series"})};var we=a(41),Re=function(e){var t=e.essence,a=e.datum;if(Object(S.f)(t)){var n=Object(S.e)(t),r=Object(S.d)(t),c=n.selectValue(a);return u.a.createElement("div",{className:"split-chart-label"},u.a.createElement("span",{className:"split-chart-dimension-title"},r.title),u.a.createElement("span",{className:"split-chart-value"},": ",Object(B.b)(c,t.timezone)))}return null},Ce=function(e){var t=Object(O.b)().customization.visualizationColors,a=e.datum,n=e.hasComparison,r=e.series.map((function(e,r){var c=t.series[r],i=e.title();return Object(pe.a)({color:c,name:i,hasComparison:n,datum:a,series:e})}));return u.a.createElement(je.a,{colorEntries:r})},He=function(e){var t=e.essence,a=e.dataset,n=e.interaction.range,r=t.getConcreteSeries().toArray(),c=t.hasComparison(),i=Object(S.b)(t),o=a.findDatumByAttribute(i,n)||{};return 1===r.length?u.a.createElement(Ee.a,{series:r[0],datum:o,showPrevious:c}):u.a.createElement(Ce,{datum:o,series:r,hasComparison:c})},ze=function(e){var t=Object(O.b)().customization.visualizationColors,a=e.chartId,n=e.interactions,r=e.visualisationStage,c=e.chartStage,i=e.essence,o=e.xScale,s=e.xTicks,l=e.selectDatum,m=e.dataset,f=n.interaction,d=l(m),v=Object(b.e)(d),g=i.getConcreteSeries(),h=u.a.createElement(Re,{essence:i,datum:d}),p=V(f)&&u.a.createElement(He,{interaction:f,essence:i,dataset:v}),j=Object(S.c)(i),E=function(e){return j.selectValue(e)},y=function(e,t){var a=t.hasComparison(),n=t.getConcreteSeries().toArray(),r=Object(se.i)(n,(function(e){return Object(Oe.b)(e,a)}));return Object(Oe.a)(e.data,r)}(v,i);if(1===g.count()){var x=g.first();return u.a.createElement(ne,{chartId:a,interactions:n,hoverContent:p,timezone:i.timezone,label:h,xScale:o,xTicks:s,chartStage:c,formatter:x.formatter(),yDomain:y,visualisationStage:r},(function(e){var t=e.yScale,a=e.lineStage;return u.a.createElement(he,{xScale:o,yScale:t,getX:E,dataset:v.data,stage:a,essence:i,series:x})}))}return u.a.createElement(ne,{chartId:a,visualisationStage:r,timezone:i.timezone,hoverContent:p,interactions:n,label:h,xScale:o,xTicks:s,chartStage:c,formatter:we.g,yDomain:y},(function(e){var a=e.yScale,n=e.lineStage;return u.a.createElement(u.a.Fragment,null,g.toArray().map((function(e,r){var c=t.series[r];return u.a.createElement(ge,{key:e.plywoodKey(),xScale:o,yScale:a,getX:E,dataset:v.data,stage:n,essence:i,series:e,color:c})})))}))};var Ve=function(e){var t=e.interactions,a=e.xScale,n=e.xTicks,r=e.essence,c=e.dataset,i=e.stage,o=r.series.count()>1,s=function(e,t){return Object(S.f)(e)?Object(b.c)(t).map((function(e,t){var a=Object(se.c)(b.f,(function(e){return e[t]}));return Object(se.c)(b.d,a)})):[b.d]}(r,c),l=k(i,s.length);return u.a.createElement(u.a.Fragment,null,o&&u.a.createElement(g.a,null,u.a.createElement(Ne,{essence:r})),s.map((function(e){var o=function(e,t){if(!Object(S.f)(t))return"no-nominal-split";var a=Object(S.e)(t).selectValue(e);return Object(B.b)(a,t.timezone)}(e(c),r);return u.a.createElement(ze,{key:o,chartId:o,interactions:t,essence:r,dataset:c,selectDatum:e,xScale:a,xTicks:n,visualisationStage:i,chartStage:l})})))},Te=function(e){return e.essence.visualizationSettings.groupSeries?u.a.createElement(Ve,e):u.a.createElement(ke,e)},Ie=a(9),De=a(164),Ae=a(85);function Me(e,t,a,n){var r,c=null,i=1/0,o=Object(Ae.a)(e);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=n.selectValue(s);if(l&&W.Range.isRange(l)){var u=l.midpoint(),m=Math.abs(u.valueOf()-t.valueOf()),f=Math.abs(a(u)-a(t));(!c||m<i)&&f<50&&(c=s,i=m)}}}catch(e){o.e(e)}finally{o.f()}return c}function Ge(e,t){return Math.round(Math.floor(e/t))*t}function Fe(e,t){var a=Object(S.c)(t);if(W.TimeRange.isTimeRange(e)){var n=t.timezone,r=a.bucket;return W.TimeRange.fromJS({start:r.floor(e.start,n),end:r.shift(r.floor(e.end,n),n,1)})}if(W.NumberRange.isNumberRange(e)){var c=a.bucket,i=Ge(e.start,c),o=Ge(e.end,c);return o-i<c&&(o+=c),W.NumberRange.fromJS({start:i,end:o})}return null}var Be=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),Object(s.a)(Object(c.a)(e),"state",{interaction:null,scrollTop:0}),Object(s.a)(Object(c.a)(e),"handleHover",(function(t,a){var n=e.state.interaction;if(!I(n)&&!D(n)){var r=e.findRangeUnderOffset(a);null!==r?V(n)&&n.range.equals(r)||e.setState({interaction:z(t,r)}):e.setState({interaction:null})}})),Object(s.a)(Object(c.a)(e),"onMouseLeave",(function(){var t=e.state.interaction;V(t)&&e.setState({interaction:null})})),Object(s.a)(Object(c.a)(e),"handleDragStart",(function(t,a){var n=e.props.essence.timezone,r=e.findValueUnderOffset(a),c=Q(r,n);e.setState({interaction:T(t,r,c)})})),Object(s.a)(Object(c.a)(e),"dragging",(function(t){var a=e.state.interaction;if(I(a)){var n=e.calculateOffset(t);if(null!==n){var r=e.findValueUnderOffset(n),c=a.start,i=a.key;e.setState({interaction:T(i,c,r)})}}})),Object(s.a)(Object(c.a)(e),"stopDragging",(function(t){var a=e.state.interaction;if(I(a)){var n=e.calculateOffset(t);if(null!==n){e.setState({interaction:null});var r=e.props,c=r.essence,i=r.saveHighlight,o=a.start,s=a.key,l=Fe(Z(o,e.findValueUnderOffset(n),c.timezone),c);i(Ie.a.of(Object(U.a)(l,Object(S.b)(c))),s)}}})),Object(s.a)(Object(c.a)(e),"scrollCharts",(function(t){var a=t.target.scrollTop;e.setState({interaction:null,scrollTop:a})})),e}return Object(r.a)(a,[{key:"calculateOffset",value:function(e){var t=this.props.chartsContainerRef;if(!t.current)return null;var a=H(e);return Object(R.a)(a,1)[0]-t.current.getBoundingClientRect().left}},{key:"findValueUnderOffset",value:function(e){return this.props.xScale.invert(e)}},{key:"findRangeUnderOffset",value:function(e){var t=this.findValueUnderOffset(e),a=this.props,n=a.essence,r=a.xScale,c=function(e,t,a,n){var r=Object(S.c)(t);return Object(S.f)(t)?Me(Object(b.b)(a).flatten().data,e,n,r):Me(Object(b.c)(a),e,n,r)}(t,n,a.dataset,r);return c&&c[Object(S.b)(n)]}},{key:"interaction",value:function(){var e=this.props.highlight;return e?function(e){return{kind:N.HIGHLIGHT,clause:e.clauses.first(),key:e.key}}(e):this.state.interaction}},{key:"render",value:function(){var e=this.interaction(),t=this.props,a=t.children,n={interaction:e,acceptHighlight:t.acceptHighlight,dropHighlight:t.dropHighlight,dragStart:this.handleDragStart,handleHover:this.handleHover,mouseLeave:this.onMouseLeave};return u.a.createElement(u.a.Fragment,null,u.a.createElement(De.a,{mouseUp:this.stopDragging,mouseMove:this.dragging,scroll:this.scrollCharts}),a(n))}}]),a}(u.a.Component),Le=a(141);function Ue(e,t){var a=Object(R.a)(e,2),n=a[0],r=a[1];if(n instanceof Date&&r instanceof Date)return function(e,t,a,n){return e.materialize(t,a,n)}(Object(Le.c)(W.TimeRange.fromJS({start:n,end:r}),!0),n,r,t);if("number"==typeof n&&"number"==typeof r)return function(e,t,a){var n=Object(ie.h)(t,a,e);return[].concat(Object(be.a)(n),[a])}(Object(Le.c)(W.NumberRange.fromJS({start:n,end:r}),!0),n,r);throw new Error("Expected domain to be continuous. Got [".concat(n,", ").concat(r,"]"))}var Pe=a(30);function Je(e,t){var a=Object(S.c)(e),n=e.getEffectiveFilter(t).clauseForReference(a.reference);return n?function(e,t,a,n){var r=a.bucket;if(t&&r instanceof q.Duration){var c=e.end,i=r.floor(c,n),o=r.shift(i,n);if(i<t&&t<o)return W.Range.fromJS({start:e.start,end:o})}return e}(Object(U.b)(n),Object(Pe.f)(e.dataCube,t),a,e.timezone):null}function Xe(e,t){return e&&t?e.extend(t):e||t}function Ke(e,t,a){var n,r,c=Object(S.c)(e),i=Je(e,t),o=function(e,t){return e.flatten().data.map((function(e){return t.selectValue(e)})).reduce(Xe,null)}(a,c);return n=i,r=o,W.Range.isRange(n)||W.Range.isRange(r)?W.Range.isRange(n)?W.Range.isRange(r)?n.union(r):n:r:null}var We=a(43),Ye=a(8),qe=ie.c(".1f");var Ze=function(e){var t=e.width,a=e.ticks,n=e.scale,r=e.timezone,c=y.a.fromSize(t,30),i=function(e,t){var a=e.domain();if(Object(R.a)(a,1)[0]instanceof Date){var n=Object(We.p)(e);return function(e){return n(Object(We.m)(e,t))}}return function(e){return String(qe(e))}}(n,r),o=a.map((function(e){var t=Object(Ye.k)(n(e));return u.a.createElement("line",{key:String(e),x1:t,y1:0,x2:t,y2:5})})),s=a.map((function(e,t){var a=n(e);return u.a.createElement("text",{key:String(e),x:a,y:17,style:{textAnchor:0===t?"start":"middle"}},i(e))}));return u.a.createElement("svg",{className:"bottom-axis",width:c.width,height:c.height},u.a.createElement("g",{className:"line-chart-axis",transform:c.getTransform()},o,s))};function Qe(e){return u.a.createElement(u.a.Fragment,null,u.a.createElement(d.a,e),u.a.createElement(v.a,Object.assign({},e,{chartComponent:$e})))}var $e=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),Object(s.a)(Object(c.a)(e),"className",m.a.name),Object(s.a)(Object(c.a)(e),"chartsRef",u.a.createRef()),e}return Object(r.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.essence,n=t.data,r=t.timekeeper,c=t.stage,i=t.highlight,o=t.dropHighlight,s=t.acceptHighlight,l=t.saveHighlight,m=Ke(a,r,n);if(!m)return u.a.createElement(f.a,{title:"No data found. Try different filters."});var d=function(e,t,a){var n=[0,a];switch(Object(S.a)(e).kind){case"number":var r=[t.start,t.end];return ie.k().clamp(!0).domain(r).range(n);case"time":var c=[t.start,t.end];return ie.n().clamp(!0).domain(c).range(n)}}(a,m,c.width-60),v=Ue(d.domain(),a.timezone),g=c.height-30;return u.a.createElement(Be,{dataset:n,xScale:d,chartsContainerRef:this.chartsRef,essence:a,highlight:i,dropHighlight:o,acceptHighlight:s,saveHighlight:l},(function(t){return u.a.createElement("div",{className:"line-chart-container"},u.a.createElement("div",{className:"line-charts",ref:e.chartsRef,style:{maxHeight:g}},u.a.createElement(Te,{interactions:t,stage:c.changeHeight(g),essence:a,xScale:d,xTicks:v,dataset:n})),u.a.createElement(Ze,{width:c.width,ticks:v,scale:d,timezone:a.timezone}))}))}}]),a}(u.a.Component)}}]);
//# sourceMappingURL=line-chart.ed28c8879cf025c74f34.js.map